// + ФК MF_Задача №9 05.10.2021 ДоговорыКонтрагентов : дополнительное соглашение
Функция ФК_ОрганизационноПравоваяФорма(Общество)      
	ОрганизационноПравоваяФорма				= "";
	ОрганизационноПравоваяФормаСокращенно	= "";
	СоответствиеОПФ = Новый Соответствие;
	СоответствиеОПФ.Вставить(НСтр("en='LLC';ru='ООО'"),НСтр("en='Limited liability company';ru='Общество с ограниченной ответственностью'"));
	СоответствиеОПФ.Вставить(НСтр("en='JSC';ru='ОАО'"),НСтр("en='Open Joint-Stock Company';ru='Открытое акционерное общество'"));
	СоответствиеОПФ.Вставить(НСтр("en='CJSC';ru='ЗАО'"),НСтр("en='Closed Joint-Stock Company';ru='Закрытое акционерное общество'"));
	СоответствиеОПФ.Вставить(НСтр("en='IE';ru='ИП'"),НСтр("en='Individual entrepreneur';ru='Индивидуальный предприниматель'"));
	Для каждого эл из СоответствиеОПФ Цикл
		Найдено = стрНайти(Общество.Наименование,эл.Ключ);
		Если НЕ Найдено = 0 Тогда
			ОрганизационноПравоваяФорма = эл.Значение+" "+СтрЗаменить(Общество.Наименование,", "+эл.Ключ,"");
			Прервать;
			
		КонецЕсли;
	КонецЦикла;
	
	Возврат ОрганизационноПравоваяФорма;
КонецФункции



// - ФК MF_Задача №9 05.10.2021 ДоговорыКонтрагентов : дополнительное соглашение
// + ФК MF_Задача №9 06.10.2021 ДоговорыКонтрагентов : дополнительное соглашение
Процедура ВернутьЕмейл(СтруктураПараметровПечати)
	Контакты = СтруктураПараметровПечати.Исполнитель.КонтактнаяИнформация;
	Для каждого стр из Контакты Цикл
		Если стр.Тип = ПредопределенноеЗначение("Перечисление.ТипыКонтактнойИнформации.АдресЭлектроннойПочты") Тогда
			СтруктураПараметровПечати.Вставить("элПочтаИсполнитель",стр.АдресЭП);
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры

// - ФК MF_Задача №9 06.10.2021 ДоговорыКонтрагентов : дополнительное соглашение
// + ФК MF_Задача №9 05.10.2021 ДоговорыКонтрагентов : дополнительное соглашение 
// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати
//
&После("ДобавитьКомандыПечати")
Процедура ФК_ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	КомандаПечати = КомандыПечати.Добавить();
	КомандаПечати.МенеджерПечати = "Справочник.ДоговорыКонтрагентов";
	КомандаПечати.Идентификатор = "ФК_ДопСоглашениеДоговора";
	КомандаПечати.Представление = НСтр("en='Additional agreement';ru='Дополнительное соглашение'");
	
КонецПроцедуры
// - ФК MF_Задача №9 05.10.2021 ДоговорыКонтрагентов : дополнительное соглашение 


// + ФК MF_Задача №9 05.10.2021 ДоговорыКонтрагентов : дополнительное соглашение 
// Формирует печатные формы.
//
// Параметры:
//  МассивОбъектов  - Массив    - ссылки на объекты, которые нужно распечатать;
//  ПараметрыПечати - Структура - дополнительные настройки печати;
//  КоллекцияПечатныхФорм - ТаблицаЗначений - сформированные табличные документы (выходной параметр).
//  ОбъектыПечати         - СписокЗначений  - значение - ссылка на объект;
//                                            представление - имя области в которой был выведен объект (выходной
//                                                            параметр);
//  ПараметрыВывода       - Структура       - дополнительные параметры сформированных табличных документов (выходной
//                                            параметр).
//
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	ПараметрыВывода.ДоступнаПечатьПоКомплектно = Истина;
	ПараметрыПечати = Новый Структура;
	//
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ФК_ДопСоглашениеДоговора") Тогда
		ПараметрыПечати.Вставить("ИмяФормы","ФК_ДопСоглашениеДоговора");
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "ФК_ДопСоглашениеДоговора",
			"Дополнительное соглашение", ФК_ПечатьДопСоглашение(МассивОбъектов, ОбъектыПечати, ПараметрыПечати));
	КонецЕсли;
	//
	//уатОбщегоНазначенияСервер.УстановитьРедактированиеПечатныхФормДокумента(КоллекцияПечатныхФорм);
	
КонецПроцедуры
// - ФК MF_Задача №9 05.10.2021 ДоговорыКонтрагентов : дополнительное соглашение 
// + ФК MF_Задача №9 05.10.2021 ДоговорыКонтрагентов : дополнительное соглашение 
Функция ФК_ПечатьДопСоглашение(МассивОбъектов, ОбъектыПечати, ПараметрыПечати) Экспорт

	УстановитьПривилегированныйРежим(Истина);
	
	ТабличныйДокумент = Новый ТабличныйДокумент;
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_" + ПараметрыПечати.ИмяФормы;
	НомерТипаДокумента = 0;
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Справочник.ДоговорыКонтрагентов.ФК_ДопСоглашениеДоговора");
	Для каждого объектМ из МассивОбъектов Цикл
		ОбластьЗаголовок 	    	= Макет.ПолучитьОбласть("Шапка");
		ОбластьПредставление        = Макет.ПолучитьОбласть("Представление");
		ОбластьП1                   = Макет.ПолучитьОбласть("П_1");
		ОбластьП2                   = Макет.ПолучитьОбласть("П_2");
		ОбластьП3                   = Макет.ПолучитьОбласть("П_3");
		ОбластьП4                   = Макет.ПолучитьОбласть("П_4");
		ОбластьП5                   = Макет.ПолучитьОбласть("П_5");
		ОбластьРеквизиты            = Макет.ПолучитьОбласть("Реквизиты");
		
		МассивПолей = Новый Массив;
		МассивПолей.Добавить("ПолноеНаименование");
		
		СтруктураПараметровПечати = Новый Структура;
		СтруктураПараметровПечати.Вставить("НомерДоговора",объектМ.Номер);
		СтруктураПараметровПечати.Вставить("ДатаДоговора",СтрЗаменить(Формат(объектМ.Дата,"ДЛФ=ДД"),"г.",""));    
		СтруктураПараметровПечати.Вставить("ДатаДопСоглашения",СтрЗаменить(Формат(ТекущаяДата(),"ДЛФ=ДД"),"г."," года"));
		СтруктураПараметровПечати.Вставить("Организация",объектМ.Организация);    
		СтруктураПараметровПечати.Вставить("Исполнитель",объектМ.Владелец);
		ДанныеИсполнителя = уатОбщегоНазначенияСервер.СведенияОЮрФизЛице(СтруктураПараметровПечати.Исполнитель); 
		ДанныеОрганизации =  уатОбщегоНазначенияСервер.СведенияОЮрФизЛице(СтруктураПараметровПечати.Организация);
		ДолжностиОрганизации = уатОбщегоНазначенияТиповые.уатОтветственныеЛицаОрганизаций(СтруктураПараметровПечати.Организация,ТекущаяДата());
		СтруктураПараметровПечати.Вставить("РуководительОрганизация",ДолжностиОрганизации.РуководительСсылка.Наименование);   
		СтруктураПараметровПечати.Вставить("РуководительОрганизацияКратко",ДолжностиОрганизации.Руководитель);
		ПредставлениеОрганизации = "";
		Жирный = Ложь;
		ТекстПО = Новый ФорматированнаяСтрока(СокрЛП(Строка(объектМ.Организация.НаименованиеПолное)),Новый Шрифт(, 10, Жирный, , , )); 
		ТекстПО1 = ", именуемое в дальнейшем “Заказчик”, в лице генерального директора " +
		            СтруктураПараметровПечати.РуководительОрганизация+", действующей на основании Устава, с одной стороны, и ";
		
		ПредставлениеОрганизации =" " + ТекстПО1; //  ТекстПО+
		СтруктураПараметровПечати.Вставить("ТекстПО",ТекстПО);
		СтруктураПараметровПечати.Вставить("ПредставлениеОрганизации",ПредставлениеОрганизации);
		ПредставлениеИсполнителя = "";		
		ТекстПИ = ФК_ОрганизационноПравоваяФорма(СтруктураПараметровПечати.Исполнитель);
		Должность = "генирального директора " ;
		Если НЕ ЗначениеЗаполнено(объектМ.Владелец.ОсновноеКонтактноеЛицо) Тогда
			СтруктураПараметровПечати.Вставить("ДолжностьИсполнитель","_______________ :");
			СтруктураПараметровПечати.Вставить("РуководительИсполнитель","____________________/_______________ /");
		Иначе
			Должность  = СокрЛП(объектМ.Владелец.ОсновноеКонтактноеЛицо.Должность);
			СтруктураПараметровПечати.Вставить("ДолжностьИсполнитель",Должность+" :");
			МасДолжность = ПолучитьСклоненияСтроки(Должность,,"ПД=Родительный");
			Должность =  НРег(МасДолжность[0]);
			СтруктураПараметровПечати.Вставить("РуководительИсполнитель","____________________/"+СокрЛП(объектМ.Владелец.ОсновноеКонтактноеЛицо.Фамилия)+"."+Лев(объектМ.Владелец.ОсновноеКонтактноеЛицо.Имя,1)+"."+Лев(объектМ.Владелец.ОсновноеКонтактноеЛицо.Отчество,1));
		КонецЕсли;

		Если СтруктураПараметровПечати.Исполнитель.ЮридическоеФизическоеЛицо = ПредопределенноеЗначение("Перечисление.ЮридическоеФизическоеЛицо.ЮридическоеЛицо") Тогда
			ТекстПИ1 = " (ИНН "+Строка(ДанныеИсполнителя.ИНН)+ ", ОГРН"+"________________"+") именуемое в дальнейшем “Исполнитель”, в лице " +Должность;
			РуководительИсполнителя = уатОбщегоНазначенияТиповые.уатОтветственныеЛицаОрганизаций(СтруктураПараметровПечати.Исполнитель,ТекущаяДата()).Руководитель;
			Если НЕ РуководительИсполнителя = Неопределено Тогда
				
			ИначеЕсли ЗначениеЗаполнено(объектМ.Владелец.ОсновноеКонтактноеЛицо) Тогда
				РуководительИсполнителя =" "+ СокрЛП(объектМ.Владелец.ОсновноеКонтактноеЛицо) ;
			Иначе  
				РуководительИсполнителя = "______________________________";
			КонецЕсли;
			ТекстПИ1 = ТекстПИ1 +РуководительИсполнителя +", действующего на основании Устава, с другой стороны,"; 
		Иначе
			ТекстПИ1 = " (ОГРНИП № "+"______________________"+ "), именуемый в дальнейшем “Исполнитель”, действующего на основании Свидетельства о государственной регистрации физического лица в качестве индивидуального предпринимателя, с другой стороны, ";
		КонецЕсли;
		
		ПредставлениеИсполнителя = ТекстПИ1;    //   ТекстПИ+"
		СтруктураПараметровПечати.Вставить("ТекстПИ",ТекстПИ);
		СтруктураПараметровПечати.Вставить("ПредставлениеИсполнителя",ПредставлениеИсполнителя);
		ОписаниеДоговора = "   совместно именуемые “Стороны”, а по отдельности “Сторона”, в рамках действия Договора № "+СтруктураПараметровПечати.НомерДоговора+" от "+СтруктураПараметровПечати.ДатаДоговора+" года на оказание транспортных и экспедиционных услуг (Далее – Договор), заключили настоящее Дополнительное соглашение о нижеследующем:";
		СтруктураПараметровПечати.Вставить("ОписаниеДоговора",ОписаниеДоговора);
		
		СтруктураПараметровПечати.Вставить("ИННОрганизация",Строка(СтруктураПараметровПечати.Организация.ИНН)+"/"+Строка(СтруктураПараметровПечати.Организация.КПП));
		СтруктураПараметровПечати.Вставить("ОГРНОрганизация",СокрЛП(СтруктураПараметровПечати.Организация.ОГРН));
		СтруктураПараметровПечати.Вставить("ЮридическийАдресОрганизация",СокрЛП(ДанныеОрганизации.ЮридическийАдрес));
				
		Если ЗначениеЗаполнено(объектМ.Владелец.ОсновнойБанковскийСчет) Тогда
			СтруктураПараметровПечати.Вставить("гдеБанкОрганизация","в "+Строка(объектМ.Владелец.ОсновнойБанковскийСчет.Банк) +" В "+Строка(объектМ.Владелец.ОсновнойБанковскийСчет.Банк.Город) );
			СтруктураПараметровПечати.Вставить("БИКОрганизация",СокрЛП(ДанныеОрганизации.БИК)); 
			СтруктураПараметровПечати.Вставить("КСОрганизация",СокрЛП(ДанныеОрганизации.КоррСчет));
			СтруктураПараметровПечати.Вставить("РсОрганизация",СокрЛП(ДанныеОрганизации.НомерСчета));	
		Иначе
			СтруктураПараметровПечати.Вставить("гдеБанкОрганизация","");    
			СтруктураПараметровПечати.Вставить("БИКОрганизация","");
			СтруктураПараметровПечати.Вставить("КСОрганизация","");       
			СтруктураПараметровПечати.Вставить("РсОрганизация",);
		КонецЕсли;
		СтруктураПараметровПечати.Вставить("ИННИсполнитель",Строка(ДанныеИсполнителя.ИНН)+"/"+Строка(ДанныеИсполнителя.КПП));
		СтруктураПараметровПечати.Вставить("ОГРНИсполнитель",);
		СтруктураПараметровПечати.Вставить("ЮридическийАдресИсполнитель",ДанныеИсполнителя.ЮридическийАдрес);
		СтруктураПараметровПечати.Вставить("РсИсполнитель",ДанныеИсполнителя.НомерСчета);
		СтруктураПараметровПечати.Вставить("гдеБанкИсполнитель","в "+Строка(ДанныеИсполнителя.Банк) +" В "+Строка(ДанныеИсполнителя.Банк.Город));
		СтруктураПараметровПечати.Вставить("КСИсполнитель",ДанныеИсполнителя.КоррСчет);
		СтруктураПараметровПечати.Вставить("БИКИсполнитель",ДанныеИсполнителя.БИК);     
		СтруктураПараметровПечати.Вставить("ДолжностьИсполнитель",);
		СтруктураПараметровПечати.Вставить("элПочтаИсполнитель",);
		ВернутьЕмейл(СтруктураПараметровПечати);
		
		
		ЗаполнитьЗначенияСвойств(ОбластьЗаголовок.Параметры,СтруктураПараметровПечати);
		ТабличныйДокумент.Вывести(ОбластьЗаголовок);
		ЗаполнитьЗначенияСвойств(ОбластьПредставление.Параметры,СтруктураПараметровПечати);
		ТабличныйДокумент.Вывести(ОбластьПредставление);
		ЗаполнитьЗначенияСвойств(ОбластьП1.Параметры,СтруктураПараметровПечати);
		ТабличныйДокумент.Вывести(ОбластьП1);
		ЗаполнитьЗначенияСвойств(ОбластьП2.Параметры,СтруктураПараметровПечати);
		ТабличныйДокумент.Вывести(ОбластьП2);
		ЗаполнитьЗначенияСвойств(ОбластьП3.Параметры,СтруктураПараметровПечати);
		ТабличныйДокумент.Вывести(ОбластьП3);
		ЗаполнитьЗначенияСвойств(ОбластьП4.Параметры,СтруктураПараметровПечати);
		ТабличныйДокумент.Вывести(ОбластьП4);
		ЗаполнитьЗначенияСвойств(ОбластьП5.Параметры,СтруктураПараметровПечати);
		ТабличныйДокумент.Вывести(ОбластьП5);
		ЗаполнитьЗначенияСвойств(ОбластьРеквизиты.Параметры,СтруктураПараметровПечати);
		ТабличныйДокумент.Вывести(ОбластьРеквизиты);

		
	КонецЦикла;
	
	ТабличныйДокумент.АвтоМасштаб = Истина;
	
	Возврат ТабличныйДокумент;
	
КонецФункции
// - ФК MF_Задача №9 05.10.2021 ДоговорыКонтрагентов : дополнительное соглашение 
