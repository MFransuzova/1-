//____________________________ АИГ _________________________________________________
// + АИГ Французова 11.01.2022 (добавление реквизтов объекта)
&НаКлиенте
Процедура АИГ_ЗаполнениеОбъектов(РезультатВопроса, ПараметрыЗаписи) Экспорт
	Если РезультатВопроса = КодВозвратаДиалога.Нет  Тогда
		Если ПараметрыЗаписи.Свойство("МассивУдалитьКлючи") Тогда
			Если НЕ ПараметрыЗаписи.МассивУдалитьКлючи.Количество() = 0 Тогда
				Для каждого эл из ПараметрыЗаписи.МассивУдалитьКлючи Цикл
					ПараметрыЗаписи.Удалить(эл);
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	ЗаполнитьЗначенияСвойств(Объект,ПараметрыЗаписи);
КонецПроцедуры
// - АИГ Французова 11.01.2022 (добавление реквизтов объекта)

// + АИГ Французова 11.01.2022 (добавление реквизтов объекта)

&НаСервере
Процедура АИГ_ВернуьЗначенияОбъекта(СтруктураДанных)
	Если НЕ СтруктураДанных.Свойство("ОбъектДанных") Тогда
		Возврат;
	КонецЕсли;
	МассивРеквизитов = Новый Массив;
	Для каждого стр из СтруктураДанных Цикл
		Если стр.Ключ = "ОбъектДанных" Тогда
			Продолжить;
		КонецЕсли;
		
		МассивРеквизитов.Добавить(стр.Ключ);
	КонецЦикла;
	МассивОбъектов = Новый Массив;
	МассивОбъектов.Добавить(СтруктураДанных.ОбъектДанных);
	СтруктураЗначений = ОбщегоНазначения.ЗначенияРеквизитовОбъектов(МассивОбъектов,МассивРеквизитов);
	Для каждого эл из СтруктураЗначений Цикл 
		ЗаполнитьЗначенияСвойств(СтруктураДанных,эл.Значение);
	КонецЦикла;
КонецПроцедуры
// - АИГ Французова 11.01.2022 (добавление реквизтов объекта)

// + АИГ Французова 11.01.2022 (добавление реквизтов объекта)
&НаКлиенте
Процедура КК_InvoicesПроектПриИзменении(Элемент)
	СтрокаНов = Элементы.КК_Invoices.ТекущиеДанные;
	СтруктураДанных = Новый Структура;
	СтруктураДанных.Вставить("КК_Контрагент",ПредопределенноеЗначение("Справочник.Контрагенты.ПустаяСсылка"));
	СтруктураДанных.Вставить("КК_ОписаниеРабот",Неопределено);
	СтруктураДанных.Вставить("КК_FinWorkNum",Неопределено);
	СтруктураДанных.Вставить("ОбъектДанных",СтрокаНов.Проект);
	АИГ_ВернуьЗначенияОбъекта(СтруктураДанных);
	СоответствиеРеквизитов = Новый Соответствие;
	СоответствиеРеквизитов.Вставить("NameOfEndCustomer","КК_Контрагент");
	СоответствиеРеквизитов.Вставить("Subject","КК_ОписаниеРабот");
	СоответствиеРеквизитов.Вставить("ProjectNo","КК_FinWorkNum");
	Для каждого эл из СоответствиеРеквизитов Цикл
		СтрокаНов[эл.Ключ] = СтруктураДанных[эл.Значение];
	КонецЦикла;
	
КонецПроцедуры
// - АИГ Французова 11.01.2022 (добавление реквизтов объекта)
// + АИГ Французова 11.01.2022 (добавление реквизтов объекта)
&НаКлиенте
Процедура КК_ПроектПриИзменении(Элемент)
	Сообщение = Новый СообщениеПользователю;
	СтруктураДанных = Новый Структура;
	СтруктураДанных.Вставить("ОбъектДанных",Объект.КК_Проект);
	Если НЕ ЗначениеЗаполнено(Объект.КК_ПодразделениеМСФО) Тогда
		СтруктураДанных.Вставить("КК_ПодразделениеМСФО",Неопределено);
	КонецЕсли; 
	СтруктураДанных.Вставить("КК_ВидДеятельности",Неопределено); 
	АИГ_ВернуьЗначенияОбъекта(СтруктураДанных);
    МассивУдалитьКлючи = Новый Массив;
	
	Если ЗначениеЗаполнено(Объект.КК_ВидДеятельности) 
		И	НЕ Объект.КК_ВидДеятельности = СтруктураДанных.КК_ВидДеятельности  Тогда  
		МассивУдалитьКлючи.Добавить("КК_ВидДеятельности");
		СтруктураДанных.Вставить("МассивУдалитьКлючи",МассивУдалитьКлючи);
		ПоказатьВопрос(Новый ОписаниеОповещения("АИГ_ЗаполнениеОбъектов", ЭтотОбъект,СтруктураДанных), "Не совпадает выбранный вид деятельности и ВД проекта.Заменить?", РежимДиалогаВопрос.ДаНет);
	Иначе
		ЗаполнитьЗначенияСвойств(Объект,СтруктураДанных);
	КонецЕсли;
		
		
КонецПроцедуры
// - АИГ Французова 11.01.2022 (добавление реквизтов объекта)
