ВЫБРАТЬ
	Хозрасчетный.Ссылка КАК Счет
ПОМЕСТИТЬ ВТ_СчетаСебестоимостьПродаж
ИЗ
	ПланСчетов.Хозрасчетный КАК Хозрасчетный
ГДЕ
	Хозрасчетный.Ссылка В ИЕРАРХИИ (ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.СебестоимостьПродаж))

ИНДЕКСИРОВАТЬ ПО
	Счет
;
ВЫБРАТЬ
	Хозрасчетный.Ссылка КАК Счет,
		Хозрасчетный.НомерСтроки КАК НомерСубконтоНоменклатура
	ПОМЕСТИТЬ СчетаЗатрат
	ИЗ
		ПланСчетов.Хозрасчетный.ВидыСубконто КАК Хозрасчетный
	ГДЕ
		Хозрасчетный.ВидСубконто = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Номенклатура)
		И Хозрасчетный.Количественный
		И Хозрасчетный.Суммовой
;
ВЫБРАТЬ
	Хозрасчетный.Ссылка КАК Счет,
	Хозрасчетный.НомерСтроки КАК НомерСубконтоСтатьиЗатрат
	ПОМЕСТИТЬ СчетаПрямыхРасходов
	ИЗ
		ПланСчетов.Хозрасчетный.ВидыСубконто КАК Хозрасчетный
	ГДЕ
		Хозрасчетный.ВидСубконто = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат)

; 
ВЫБРАТЬ
     ВЫБОР КОГДА Обороты.КорСубконто4 ССЫЛКА Справочник.КК_ВидыДеятельности ТОГДА Обороты.КорСубконто4
     КОГДА Обороты.КорСубконто3 ССЫЛКА Справочник.КК_ВидыДеятельности ТОГДА Обороты.КорСубконто3
     КОГДА Обороты.КорСубконто2 ССЫЛКА Справочник.КК_ВидыДеятельности ТОГДА Обороты.КорСубконто2
     КОГДА Обороты.КорСубконто1 ССЫЛКА Справочник.КК_ВидыДеятельности ТОГДА Обороты.КорСубконто1

     ИНАЧЕ НЕОПРЕДЕЛЕНО КОНЕЦ
     КАК КК_ВидДеятельности,
	Обороты.КорСчет КАК СчетДт,
	ЕСТЬNULL(Обороты.ПодразделениеКор, &ПустоеПодразделение) КАК ПодразделениеДт,
	ЕСТЬNULL(Обороты.КорСубконто1, НЕОПРЕДЕЛЕНО) КАК СубконтоДт1,
	ЕСТЬNULL(Обороты.КорСубконто2, НЕОПРЕДЕЛЕНО) КАК СубконтоДт2,
	ЕСТЬNULL(Обороты.КорСубконто3, НЕОПРЕДЕЛЕНО) КАК СубконтоДт3,
	ЕСТЬNULL(Обороты.КорСубконто4, НЕОПРЕДЕЛЕНО) КАК СубконтоДт4,
	Обороты.Счет КАК СчетКт,
	ЕСТЬNULL(Обороты.Подразделение, &ПустоеПодразделение) КАК ПодразделениеКт,
	ЕСТЬNULL(Обороты.Субконто1, НЕОПРЕДЕЛЕНО) КАК СубконтоКт1,
	ЕСТЬNULL(Обороты.Субконто2, НЕОПРЕДЕЛЕНО) КАК СубконтоКт2,
	ЕСТЬNULL(Обороты.Субконто3, НЕОПРЕДЕЛЕНО) КАК СубконтоКт3,
	ЕСТЬNULL(Обороты.Субконто4, НЕОПРЕДЕЛЕНО) КАК СубконтоКт4,
	ЛОЖЬ КАК ФиксированнаяСтоимость,
	Обороты.Счет = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПриобретениеМалоценногоОборудованияИЗапасов) КАК ДанныеЗабалансовогоУчета,
	Обороты.Счет = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПриобретениеМалоценногоОборудованияИЗапасов)
		И Обороты.КорСчет <> ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПриобретениеМалоценногоОборудованияИЗапасов) КАК ПереходНаЗабалансовыйУчет,
	ЕСТЬNULL(Обороты.КоличествоОборотКт, 0) КАК Количество,
	ЕСТЬNULL(Обороты.СуммаОборотКт, 0) КАК Сумма,
	ЕСТЬNULL(Обороты.СуммаНУОборотКт, 0) КАК СуммаНУ,
	ЕСТЬNULL(Обороты.СуммаПРОборотКт, 0) КАК СуммаПР,
	ЕСТЬNULL(Обороты.СуммаВРОборотКт, 0) КАК СуммаВР
ПОМЕСТИТЬ ВТ_Выбытия
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Обороты(
			&НачалоПериода,
			&КонецПериода,
			,
			Счет В
				(ВЫБРАТЬ
					СчетаЗатрат.Счет
				ИЗ
					СчетаЗатрат),
			,
			
			,
			) КАК Обороты
			;
			
		ВЫБРАТЬ
        
                Обороты.КК_ВидДеятельности КАК КК_ВидДеятельности,	
		Обороты.СчетДт КАК СчетДт,
		Обороты.ПодразделениеДт КАК ПодразделениеДт,
		Обороты.СубконтоДт1 КАК СубконтоДт1,
		Обороты.СубконтоДт2 КАК СубконтоДт2,
		Обороты.СубконтоДт3 КАК СубконтоДт3,
		Обороты.СубконтоДт4 КАК СубконтоДт4,
		Обороты.НоменклатураДт КАК НоменклатураДт,
		Обороты.СчетКт КАК СчетКт,
		Обороты.ПодразделениеКт КАК ПодразделениеКт,
		Обороты.СубконтоКт1 КАК СубконтоКт1,
		Обороты.СубконтоКт2 КАК СубконтоКт2,
		Обороты.СубконтоКт3 КАК СубконтоКт3,
		Обороты.СубконтоКт4 КАК СубконтоКт4,
		Обороты.НоменклатураКт КАК НоменклатураКт,
		Обороты.Выпуск КАК Выпуск,
		Обороты.ФиксированнаяСтоимость КАК ФиксированнаяСтоимость,
		Обороты.ДанныеЗабалансовогоУчета КАК ДанныеЗабалансовогоУчета,
		Обороты.ПереходНаЗабалансовыйУчет КАК ПереходНаЗабалансовыйУчет,
		СУММА(Обороты.Количество) КАК Количество,
		СУММА(Обороты.Сумма) КАК Сумма,
		СУММА(Обороты.СуммаНУ) КАК СуммаНУ,
		СУММА(Обороты.СуммаПР) КАК СуммаПР,
		СУММА(Обороты.СуммаВР) КАК СуммаВР
ПОМЕСТИТЬ ВТ_ВыбытияВыпуск
	ИЗ
		(ВЫБРАТЬ
	       Обороты.КК_ВидДеятельности КАК КК_ВидДеятельности,
			Обороты.СчетДт КАК СчетДт,
			Обороты.ПодразделениеДт КАК ПодразделениеДт,
			Обороты.СубконтоДт1 КАК СубконтоДт1,
			Обороты.СубконтоДт2 КАК СубконтоДт2,
			Обороты.СубконтоДт3 КАК СубконтоДт3,
			Обороты.СубконтоДт4 КАК СубконтоДт4,
			ВЫБОР
				КОГДА СчетаЗапасовДт.НомерСубконтоНоменклатура = 1
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоДт1 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовДт.НомерСубконтоНоменклатура = 2
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоДт2 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовДт.НомерСубконтоНоменклатура = 3
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоДт3 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовДт.НомерСубконтоНоменклатура = 4
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоДт4 КАК Справочник.Номенклатура)
				КОГДА СчетаПрямыхРасходовДт.Счет ЕСТЬ NULL
					ТОГДА ЗНАЧЕНИЕ(Справочник.Номенклатура.ПустаяСсылка)
				КОГДА СчетаЗапасовКт.НомерСубконтоНоменклатура = 1
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоКт1 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовКт.НомерСубконтоНоменклатура = 2
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоКт2 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовКт.НомерСубконтоНоменклатура = 3
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоКт3 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовКт.НомерСубконтоНоменклатура = 4
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоКт4 КАК Справочник.Номенклатура)
				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Номенклатура.ПустаяСсылка)
			КОНЕЦ КАК НоменклатураДт,
			Обороты.СчетКт КАК СчетКт,
			Обороты.ПодразделениеКт КАК ПодразделениеКт,
			Обороты.СубконтоКт1 КАК СубконтоКт1,
			Обороты.СубконтоКт2 КАК СубконтоКт2,
			Обороты.СубконтоКт3 КАК СубконтоКт3,
			Обороты.СубконтоКт4 КАК СубконтоКт4,
			ВЫБОР
				КОГДА СчетаЗапасовКт.НомерСубконтоНоменклатура = 1
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоКт1 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовКт.НомерСубконтоНоменклатура = 2
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоКт2 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовКт.НомерСубконтоНоменклатура = 3
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоКт3 КАК Справочник.Номенклатура)
				КОГДА СчетаЗапасовКт.НомерСубконтоНоменклатура = 4
					ТОГДА ВЫРАЗИТЬ(Обороты.СубконтоКт4 КАК Справочник.Номенклатура)
				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Номенклатура.ПустаяСсылка)
			КОНЕЦ КАК НоменклатураКт,
			ЛОЖЬ КАК Выпуск,
			Обороты.ФиксированнаяСтоимость КАК ФиксированнаяСтоимость,
			ЛОЖЬ КАК ДанныеЗабалансовогоУчета,
			ЛОЖЬ КАК ПереходНаЗабалансовыйУчет,
			Обороты.Количество КАК Количество,
			ВЫБОР
				КОГДА Обороты.ДанныеЗабалансовогоУчета
					ТОГДА 0
				ИНАЧЕ Обороты.Сумма
			КОНЕЦ КАК Сумма,
			Обороты.СуммаНУ КАК СуммаНУ,
			ВЫБОР
				КОГДА Обороты.ДанныеЗабалансовогоУчета
					ТОГДА 0
				ИНАЧЕ Обороты.СуммаПР
			КОНЕЦ КАК СуммаПР,
			ВЫБОР
				КОГДА Обороты.ДанныеЗабалансовогоУчета
					ТОГДА -Обороты.СуммаНУ
				ИНАЧЕ Обороты.СуммаВР
			КОНЕЦ КАК СуммаВР
		ИЗ
			ВТ_Выбытия КАК Обороты
				ЛЕВОЕ СОЕДИНЕНИЕ СчетаЗатрат КАК СчетаЗапасовДт
				ПО Обороты.СчетДт = СчетаЗапасовДт.Счет
				ЛЕВОЕ СОЕДИНЕНИЕ СчетаЗатрат КАК СчетаЗапасовКт
				ПО Обороты.СчетКт = СчетаЗапасовКт.Счет
				ЛЕВОЕ СОЕДИНЕНИЕ СчетаПрямыхРасходов КАК СчетаПрямыхРасходовДт
				ПО Обороты.СчетДт = СчетаПрямыхРасходовДт.Счет ) КАК Обороты
СГРУППИРОВАТЬ ПО
        Обороты.КК_ВидДеятельности ,	
		Обороты.СчетДт,
		Обороты.ПодразделениеДт,
		Обороты.СубконтоДт1,
		Обороты.СубконтоДт2,
		Обороты.СубконтоДт3,
		Обороты.СубконтоДт4,
		Обороты.НоменклатураДт,
		Обороты.СчетКт,
		Обороты.ПодразделениеКт,
		Обороты.СубконтоКт1,
		Обороты.СубконтоКт2,
		Обороты.СубконтоКт3,
		Обороты.СубконтоКт4,
		Обороты.НоменклатураКт,
		Обороты.Выпуск,
		Обороты.ФиксированнаяСтоимость,
		Обороты.ДанныеЗабалансовогоУчета,
		Обороты.ПереходНаЗабалансовыйУчет	
					
