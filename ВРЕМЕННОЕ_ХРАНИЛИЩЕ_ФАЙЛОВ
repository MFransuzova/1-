
// + АИГ Французова 20.01.2022 (Отображение данных файлов)
Процедура ОтобразитьФайлПротокола(СтруктураДанных)
	ДвоичныеДанные = ПолучитьИзВременногоХранилища(СтруктураДанных.АдресФайлаПротокола);
	Поток = ДвоичныеДанные.ОткрытьПотокДляЧтения() ;
	ПротоколТрансляции.Прочитать(Поток);
	Поток.Закрыть();
КонецПроцедуры

// - АИГ Французова 20.01.2022 (Отображение данных файлов)
// + АИГ Французова 19.01.2022 (Перенос данных трансляция)
&НаСервере
Процедура АИГ_СоздатьПроверитьФайлПротокола(СтруктураДанных)

	СтруктураДанных.Вставить("ТекстПротокола","");
	Год      = Год(ТекущаяДата());
	Год      = Формат(Год,"ЧЦ=4; ЧРГ=''; ЧГ=0");
	День     = Формат(День(ТекущаяДата()),  "ЧЦ=2; ЧВН=");
	Месяц    = Формат(Месяц(ТекущаяДата()), "ЧЦ=2; ЧВН=");
	ИмяФайла = Каталогвременныхфайлов()+Год+"-"+Месяц+"-"+День+".txt";
	СтруктураДанных.Вставить("ИмяФайла",ИмяФайла);
	
	ТекстПротокола = Новый ТекстовыйДокумент;
	//ТекстПротокола.Прочитать(ИмяФайла,КодировкаТекста.ANSI);
	ТекстПротокола.ДобавитьСтроку("===============================================");
	ТекстПротокола.ДобавитьСтроку("Протокол трансляции  за "+ ТекущаяДата()+".  Начало");
	//ТекстПротокола.Записать(ИмяФайла,КодировкаТекста.ANSI);
	//ДвоичныеДанные = Новый ДвоичныеДанные(ИмяФайла);
	//АдресФайлаПротокола = ПоместитьВоВременноеХранилище(ДвоичныеДанные, УникальныйИдентификатор);
	//СтруктураДанных.Вставить("АдресФайлаПротокола",АдресФайлаПротокола);
	СтруктураДанных.Вставить("ТекстПротокола",ТекстПротокола);
	
КонецПроцедуры
// - АИГ Французова 19.01.2022 (Перенос данных трансляция)
// + АИГ Французова 19.01.2022 (Перенос данных трансляция)
&НаСервере
Процедура АИГ_ЗаписатьФайлПротокола(СтруктураДанных)
	Если НЕ СтруктураДанных.Свойство("ТекстПротокола") Тогда
		Возврат;
	КонецЕсли;
	
	ТекстПротокола = СтруктураДанных.ТекстПротокола;
	ТекстПротокола.ДобавитьСтроку("Протокол трансляции  за "+ ТекущаяДата()+".  Конец");
	ТекстПротокола.ДобавитьСтроку("===============================================");
	ТекстПротокола.Записать(СтруктураДанных.ИмяФайла,КодировкаТекста.ANSI);
	СтруктураДанных.Вставить("ТекстПротокола",ТекстПротокола);
	
	ДвоичныеДанные = Новый ДвоичныеДанные(СтруктураДанных.ИмяФайла);
	АдресФайлаПротокола = ПоместитьВоВременноеХранилище(ДвоичныеДанные, УникальныйИдентификатор);
	СтруктураДанных.Вставить("АдресФайлаПротокола",АдресФайлаПротокола);
	ОтобразитьФайлПротокола(СтруктураДанных);
КонецПроцедуры
// - АИГ Французова 19.01.2022 (Перенос данных трансляция)

// + АИГ Французова 18.01.2022 (адаптация для 8.3 УФ)

&НаСервере
Процедура КомандаВыполнитьНаСервере(СтруктураДанных)
	АИГ_СоздатьПроверитьФайлПротокола(СтруктураДанных);
	//Возврат;
	//СтруктураДанных.Вставить("ТолькоИзменения",Ложь);
	//СтруктураДанных.Вставить("ДатаС",Объект.ДатаС);
	//СтруктураДанных.Вставить("ДатаПо",Объект.ДатаПо);
	//Если СтруктураДанных.ВидПереноса = 1 Тогда
	//	СтруктураДанных.Вставить("ТолькоИзменения",Истина) ;
	//КонецЕсли; 
	//ВыполнитьПереносПроводок(СтруктураДанных);
	АИГ_ЗаписатьФайлПротокола(СтруктураДанных);
	
КонецПроцедуры
// - АИГ Французова 18.01.2022 (адаптация для 8.3 УФ)
