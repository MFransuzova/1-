// + ДБ Французова 23.12.2022  (2024 изменить браузер вывода) 
&Вместо("ПерейтиПоСсылкеВИнтернетЭксплорере")
&НаКлиенте         
Процедура ДБ_ПерейтиПоСсылкеВИнтернетЭксплорере(АдресСсылки) Экспорт
	
	СтрокаОС = ЭлектронныйДокументооборотСКонтролирующимиОрганамиКлиентСервер.СтрокаОС();
	
	Если СтрНайти(СтрокаОС, "Windows") = 0 Тогда
		
		ДлительнаяОтправкаКлиентСервер.ВывестиОшибку(НСтр("ru = 'Для работы с сервисом требуется операционная система семейства Windows';
															|en = 'To use the service, Microsoft Windows OS is required'"));
		Возврат;
		
	КонецЕсли;
	
	#Если ВебКлиент Тогда
		//это веб клиент
		ВебБраузер = РегламентированнаяОтчетностьКлиент.ВебБраузер();
		Если ВебБраузер = "MSIE" Тогда
			//это IE
			ПерейтиПоНавигационнойСсылке(АдресСсылки);
		Иначе
			//это не IE
			ПерейтиПоСсылкеВИнтернетЭксплоререНасильно(АдресСсылки);
		КонецЕсли;
	#Иначе
		//это тонкий клиент 
		// + ДБ Французова 23.12.2022  (2024 изменить браузер вывода)
		
		ДБ_ПерейтиПоСсылкеВХромеНасильно(АдресСсылки);
		// - ДБ Французова 23.12.2022   (2024 изменить браузер вывода)
			
	#КонецЕсли
	
КонецПроцедуры   
// - ДБ Французова 23.12.2022   (2024 изменить браузер вывода)

// + ДБ Французова 23.12.2022  (2024 изменить браузер вывода) 
&НаКлиенте
Процедура ДБ_ПерейтиПоСсылкеВХромеНасильно(АдресСсылки)  
		ОперацииСФайламиЭДКОКлиент.ЗапуститьПриложениеНаКлиенте(, "rundll32 shell32.dll, ShellExec_RunDLL chrome " + АдресСсылки);
КонецПроцедуры

// - ДБ Французова 23.12.2022   (2024 изменить браузер вывода)
