 ВЫБРАТЬ    
НАЧАЛОПЕРИОДА(&ДатаН,МЕСЯЦ) КАК ПериодЗапроса,
Рег.Сотрудник,   
ВЫРАЗИТЬ(Рег.Сотрудник КАК Справочник.Сотрудники).Код КАК ТабельныйНомер,
Рег.ГоловнаяОрганизация КАК Организация,
Рег.ДатаУвольнения,
Рег.ДатаПриема,
ВЫРАЗИТЬ(Рег.Сотрудник КАК Справочник.Сотрудники).ФизическоеЛицо КАК ФизическоеЛицо 
ПОМЕСТИТЬ СотрудникиОтбора
ИЗ  РегистрСведений.ТекущиеКадровыеДанныеСотрудников КАК Рег  
{ГДЕ Рег.Сотрудник = &Сотрудник}
;
ВЫБРАТЬ ПЕРВЫЕ 100000
Рег.ДатаНачала, 
Рег.ДатаОкончания КАК Период,
////Рег.Регистратор,
Рег.Сотрудник,
Рег.Организация КАК Организация,
Рег.Подразделение КАК ОтделСлужба,
Рег.Должность,
Рег.ДолжностьПоШтатномуРасписанию КАК ДолжностьПоШтатномуРасписанию,
Рег.ВидСобытия,
Рег.КоличествоСтавок 
ПОМЕСТИТЬ КадроваяИсторияСотрудника
ИЗ РегистрСведений.КадроваяИсторияСотрудниковИнтервальный КАК РЕг  
ГДЕ Рег.Сотрудник В (ВЫБРАТЬ СотрудникиОтбора.Сотрудник ИЗ СотрудникиОтбора КАК СотрудникиОтбора)   
И (Рег.ДатаОкончания МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,МЕСЯЦ) И КОНЕЦПЕРИОДА(&ДатаК,МЕСЯЦ) 
ИЛИ   Рег.ДатаНачала МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,МЕСЯЦ) И КОНЕЦПЕРИОДА(&ДатаК,МЕСЯЦ)
ИЛИ (КОНЕЦПЕРИОДА(&ДатаК,МЕСЯЦ)< Рег.ДатаОкончания И  КОНЕЦПЕРИОДА(&ДатаК,МЕСЯЦ) > Рег.ДатаНачала))     

УПОРЯДОЧИТЬ ПО 
Рег.Сотрудник ВОЗР,
Рег.ДатаНачала ВОЗР 
;
ВЫБРАТЬ                                            
КадроваяИсторияСотрудника.ДатаНачала КАК ДатаНачала,
КадроваяИсторияСотрудника.Период КАК ДатаОкончания,
КадроваяИсторияСотрудника.Сотрудник,
КадроваяИсторияСотрудника.Организация,
КадроваяИсторияСотрудника.ОтделСлужба,
КадроваяИсторияСотрудника.Должность,
КадроваяИсторияСотрудника.ДолжностьПоШтатномуРасписанию,
КадроваяИсторияСотрудника.КоличествоСтавок,
ОТВ.Период,
СУММА(ОТВ.ОтработаноДней)                   
ПОМЕСТИТЬ КИ_ОТВ
ИЗ КадроваяИсторияСотрудника КАК КадроваяИсторияСотрудника     
ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ОтработанноеВремяПоСотрудникам КАК ОТВ
ПО ОТВ.Сотрудник = КадроваяИсторияСотрудника.Сотрудник
И КадроваяИсторияСотрудника.ОтделСлужба = ОТВ.Подразделение
И (ОТВ.Период МЕЖДУ НАЧАЛОПЕРИОДА(КадроваяИсторияСотрудника.ДатаНачала,МЕСЯЦ) И КадроваяИсторияСотрудника.Период)   
И ОТВ.Период МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,МЕСЯЦ) И КОНЕЦПЕРИОДА(&ДатаК,МЕСЯЦ)  
ГДЕ  ОТВ.ОтработаноДней >0 
СГРУППИРОВАТЬ ПО  
КадроваяИсторияСотрудника.ДатаНачала,
КадроваяИсторияСотрудника.Период ,
КадроваяИсторияСотрудника.Сотрудник,
КадроваяИсторияСотрудника.Организация,
КадроваяИсторияСотрудника.ОтделСлужба,
КадроваяИсторияСотрудника.Должность,
КадроваяИсторияСотрудника.ДолжностьПоШтатномуРасписанию,
КадроваяИсторияСотрудника.КоличествоСтавок,
ОТВ.Период
;
ВЫБРАТЬ                
ШР.Ссылка,
ШР.Родитель,
ШР.Подразделение, 
ВЫРАЗИТЬ(ШР.Подразделение КАК Справочник.ПодразделенияОрганизаций).Родитель КАК Департамент,
ШР.Должность,
ШР.ОкладТариф,
ШР.ГруппаПозицийПодразделения,
Премия1кв.Значение КАК ЗначениеПремия1кв ,    
Премия2кв.Значение КАК ЗначениеПремия2кв ,    
Премия3кв.Значение КАК ЗначениеПремия3кв,  
Премия4кв.Значение КАК ЗначениеПремия4кв , 
Премия1Полугодие.Значение КАК Премия1Полугодие,
Премия2Полугодие.Значение КАК Премия2Полугодие,

ПремияГодовая.Значение КАК ПремияГодовая,
	ВЫБОР
		КОГДА &ПараметрыПремии = 1
			ТОГДА Премия1кв.Значение
		КОГДА &ПараметрыПремии = 2
			ТОГДА Премия2кв.Значение   
		КОГДА &ПараметрыПремии = 3
			ТОГДА Премия3кв.Значение	   
		КОГДА &ПараметрыПремии = 4
			ТОГДА Премия4кв.Значение	
		КОГДА &ПараметрыПремии = 5
			ТОГДА Премия1Полугодие.Значение
		КОГДА &ПараметрыПремии = 6
			ТОГДА Премия2Полугодие.Значение
		КОГДА &ПараметрыПремии = 7
			ТОГДА ПремияГодовая.Значение
	КОНЕЦ КАК ПремияОбщая
ПОМЕСТИТЬ ШтатноеРасписаниеСотрудников 

ИЗ Справочник.ШтатноеРасписание КАК ШР        
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ШтатноеРасписание.ДополнительныеРеквизиты КАК Премия1кв
		ПО ШР.Ссылка = Премия1кв.Ссылка
			И (Премия1кв.Свойство.ИдентификаторДляФормул = "Премия1кв")   
	    ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ШтатноеРасписание.ДополнительныеРеквизиты КАК Премия2кв
		ПО ШР.Ссылка = Премия2кв.Ссылка
			И (Премия2кв.Свойство.ИдентификаторДляФормул = "Премия2кв")
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ШтатноеРасписание.ДополнительныеРеквизиты КАК Премия3кв
		ПО ШР.Ссылка = Премия3кв.Ссылка
			И (Премия3кв.Свойство.ИдентификаторДляФормул = "Премия3кв")
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ШтатноеРасписание.ДополнительныеРеквизиты КАК Премия4кв
		ПО ШР.Ссылка = Премия4кв.Ссылка
			И (Премия4кв.Свойство.ИдентификаторДляФормул = "Премия4кв")			
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ШтатноеРасписание.ДополнительныеРеквизиты КАК Премия1Полугодие
		ПО ШР.Ссылка = Премия1Полугодие.Ссылка
			И (Премия1Полугодие.Свойство.ИдентификаторДляФормул = "Премия1Полугодие")
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ШтатноеРасписание.ДополнительныеРеквизиты КАК Премия2Полугодие
		ПО ШР.Ссылка = Премия2Полугодие.Ссылка
			И (Премия2Полугодие.Свойство.ИдентификаторДляФормул = "Премия2Полугодие")
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ШтатноеРасписание.ДополнительныеРеквизиты КАК ПремияГодовая
		ПО ШР.Ссылка = ПремияГодовая.Ссылка
			И (ПремияГодовая.Свойство.ИдентификаторДляФормул = "ПремияГодовая")

ГДЕ ШР.Ссылка В (ВЫБРАТЬ КадроваяИсторияСотрудника.ДолжностьПоШтатномуРасписанию ИЗ КадроваяИсторияСотрудника КАК КадроваяИсторияСотрудника)
; 
ВЫБРАТЬ 
 ОтработанноеВремя.Период,
 ОтработанноеВремя.Сотрудник,
 ОтработанноеВремя.Подразделение,
 КИ_ОТВ.ДолжностьПоШтатномуРасписанию КАК ДолжностьПоШтатномуРасписанию,
 КИ_ОТВ.КоличествоСтавок,
 КИ_ОТВ.ДатаНачала, 
 КИ_ОТВ.ДатаОкончания,
 КИ_ОТВ.Должность,
 СУММА(ОтработанноеВремя.ОтработаноДней) КАК ОтработаноДней 
 ПОМЕСТИТЬ ОтработанноеВремяПоПериодам
 ИЗ РегистрНакопления.ОтработанноеВремяПоСотрудникам КАК ОтработанноеВремя
 ЛЕВОЕ СОЕДИНЕНИЕ КИ_ОТВ КАК КИ_ОТВ ПО 
 КИ_ОТВ.Сотрудник = ОтработанноеВремя.Сотрудник
 И  ОтработанноеВремя.Период = КИ_ОТВ.Период 
 И  КИ_ОТВ.ОтделСлужба = ОтработанноеВремя.Подразделение   
 ГДЕ ОтработанноеВремя.Сотрудник В (ВЫБРАТЬ СотрудникиОтбора.Сотрудник ИЗ СотрудникиОтбора КАК СотрудникиОтбора) 
   И ОтработанноеВремя.Период МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,МЕСЯЦ) И КОНЕЦПЕРИОДА(&ДатаК,МЕСЯЦ)  
   И  ОтработанноеВремя.ОтработаноДней>0      
   И НЕ ОтработанноеВремя.Начисление.Код = &кодНачисления
    
 СГРУППИРОВАТЬ ПО
    ОтработанноеВремя.Период,
    ОтработанноеВремя.Сотрудник,
    ОтработанноеВремя.Подразделение,
    КИ_ОТВ.ДолжностьПоШтатномуРасписанию,
    КИ_ОТВ.КоличествоСтавок,
    КИ_ОТВ.ДатаНачала,
    КИ_ОТВ.ДатаОкончания,
    КИ_ОТВ.Должность
 ;     
 ВЫБРАТЬ
 ОтработанноеВремяПоПериодам.Сотрудник,
 ОтработанноеВремяПоПериодам.Подразделение, 
 ОтработанноеВремяПоПериодам.ДолжностьПоШтатномуРасписанию,
 ОтработанноеВремяПоПериодам.КоличествоСтавок,
 ОтработанноеВремяПоПериодам.ДатаНачала,  
 ОтработанноеВремяПоПериодам.ДатаОкончания,
 ОтработанноеВремяПоПериодам.Должность,
 СУММА(ОтработанноеВремяПоПериодам.ОтработаноДней) КАК ОтработаноДней    
 ПОМЕСТИТЬ ОтработанновеВремяВДолжности
 ИЗ ОтработанноеВремяПоПериодам КАК ОтработанноеВремяПоПериодам 
  
 СГРУППИРОВАТЬ ПО
 ОтработанноеВремяПоПериодам.Сотрудник,
 ОтработанноеВремяПоПериодам.Подразделение, 
 ОтработанноеВремяПоПериодам.ДолжностьПоШтатномуРасписанию, 
 ОтработанноеВремяПоПериодам.КоличествоСтавок,
 ОтработанноеВремяПоПериодам.ДатаНачала,  
 ОтработанноеВремяПоПериодам.ДатаОкончания,
 ОтработанноеВремяПоПериодам.Должность  
 
; 
ВЫБРАТЬ
Рег.Сотрудник,
Рег.Организация,
Рег.ДатаЗавершения 
ПОМЕСТИТЬ ИспытательныйСрок
ИЗ РегистрСведений.ИспытательныйСрокСотрудников КАК Рег  
ГДЕ Рег.Сотрудник В (ВЫБРАТЬ СотрудникиОтбора.Сотрудник ИЗ СотрудникиОтбора КАК СотрудникиОтбора)
;   
ВЫБРАТЬ 
 Рег.Сотрудник,
 МАКСИМУМ(Рег.Начало)                                     
 ПОМЕСТИТЬ ПоследниееСостояние
ИЗ РегистрСведений.ДанныеСостоянийСотрудников КАК Рег      
ГДЕ Рег.Сотрудник В (ВЫБРАТЬ СотрудникиОтбора.Сотрудник ИЗ СотрудникиОтбора КАК СотрудникиОтбора)  
И Рег.Окончание = ДАТАВРЕМЯ(1,1,1)
СГРУППИРОВАТЬ ПО 
 Рег.Сотрудник
 ;
ВЫБРАТЬ
ТекСостояние.Сотрудник,
ТекСостояние.Состояние,
ТекСостояние.Начало          
ПОМЕСТИТЬ СостоянияСотрудников
ИЗ РегистрСведений.ДанныеСостоянийСотрудников КАК ТекСостояние 
ВНУТРЕННЕЕ СОЕДИНЕНИЕ ПоследниееСостояние КАК ПоследниееСостояние 
 ПО ПоследниееСостояние.Сотрудник = ТекСостояние.Сотрудник И ПоследниееСостояние.Начало = ТекСостояние.Начало
;         

ВЫБРАТЬ  ПЕРВЫЕ 100
Рег.Сотрудник,
Рег.Состояние,
Рег.Начало,
Рег.Окончание   
ПОМЕСТИТЬ БИР
ИЗ РегистрСведений.ДанныеСостоянийСотрудников КАК Рег 
ГДЕ Рег.Сотрудник В (ВЫБРАТЬ СотрудникиОтбора.Сотрудник ИЗ СотрудникиОтбора КАК СотрудникиОтбора)
И Рег.Состояние = ЗНАЧЕНИЕ(Перечисление.СостоянияСотрудника.ОтпускПоБеременностиИРодам)   
И ((Рег.Начало МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ))      
ИЛИ (Рег.Окончание МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ))) 
;
ВЫБРАТЬ       
НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) КАК ПериодЗапроса,
СУММА(ДанныеПроизводственногоКалендаряПомесячно.РабочихДней) КАК КоличествоРабочиДнейПериода  
ПОМЕСТИТЬ РабочиеДниПериода
ИЗ РегистрСведений.ДанныеПроизводственногоКалендаряПомесячно КАК ДанныеПроизводственногоКалендаряПомесячно  
ГДЕ ДанныеПроизводственногоКалендаряПомесячно.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ)
СГРУППИРОВАТЬ ПО   
НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ)
;            
ВЫБРАТЬ       
ДанныеПроизводственногоКалендаряПомесячно.Месяц,
ДанныеПроизводственногоКалендаряПомесячно.РабочихДней  
ПОМЕСТИТЬ РабочиеДниПоПериодам
ИЗ РегистрСведений.ДанныеПроизводственногоКалендаряПомесячно КАК ДанныеПроизводственногоКалендаряПомесячно  
ГДЕ ДанныеПроизводственногоКалендаряПомесячно.Месяц МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ)
;
ВЫБРАТЬ   
УровеньРодителяДепортамента.Ссылка КАК ПД,
УровеньРодителяДепортамента.Значение КАК УровеньПД,
Рег.Ссылка.Родитель КАК Департамент,  
УровеньРодителя.Значение КАК УровеньРодителя, 
Рег.Ссылка КАК Подразделение,
Рег.Свойство,  
Рег.Значение  КАК УровеньПодразделения  
ПОМЕСТИТЬ УровниПодразделений
ИЗ Справочник.ПодразделенияОрганизаций.ДополнительныеРеквизиты КАК Рег   
ЛЕВОЕ СОЕДИНЕНИЕ   Справочник.ПодразделенияОрганизаций.ДополнительныеРеквизиты КАК УровеньРодителя ПО Рег.Ссылка.Родитель = УровеньРодителя.Ссылка  И УровеньРодителя.Свойство=&Свойство   
ЛЕВОЕ СОЕДИНЕНИЕ   Справочник.ПодразделенияОрганизаций.ДополнительныеРеквизиты КАК УровеньРодителяДепортамента ПО УровеньРодителя.Ссылка.Родитель = УровеньРодителяДепортамента.Ссылка  
И УровеньРодителяДепортамента.Свойство=&Свойство
ГДЕ Рег.Свойство=&Свойство    
И (Рег.Ссылка,Рег.Ссылка.Родитель) В (ВЫБРАТЬ ШтатноеРасписаниеСотрудников.Подразделение,ШтатноеРасписаниеСотрудников.Департамент ИЗ ШтатноеРасписаниеСотрудников КАК ШтатноеРасписаниеСотрудников)
;   
ВЫБРАТЬ    

ВЫБОР      
КОГДА   УровниПодразделений.УровеньПодразделения.Наименование = &ГД  ТОГДА   
        ВЫРАЗИТЬ(УровниПодразделений.Подразделение КАК Справочник.ПодразделенияОрганизаций).Родитель
КОГДА   УровниПодразделений.УровеньРодителя.Наименование = &ГД1   ТОГДА   
         ВЫРАЗИТЬ(УровниПодразделений.Департамент КАК Справочник.ПодразделенияОрганизаций).Родитель   
КОГДА   УровниПодразделений.УровеньРодителя.Наименование = &ГД2 ТОГДА  
        ВЫБОР КОГДА ВЫРАЗИТЬ(УровниПодразделений.Департамент.Родитель КАК Справочник.ПодразделенияОрганизаций).Родитель = NULL ТОГДА   
          ВЫРАЗИТЬ(УровниПодразделений.Департамент.Родитель КАК Справочник.ПодразделенияОрганизаций).Родитель
        ИНАЧЕ   
          УровниПодразделений.Департамент.Родитель 
        КОНЕЦ   
КОГДА   УровниПодразделений.УровеньРодителя.Наименование = &ГД3 ТОГДА      
      ВЫБОР 
      КОГДА ВЫРАЗИТЬ(УровниПодразделений.Департамент.Родитель.Родитель КАК Справочник.ПодразделенияОрганизаций).Родитель = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка) ТОГДА 
          ВЫРАЗИТЬ(УровниПодразделений.Департамент.Родитель КАК Справочник.ПодразделенияОрганизаций).Родитель
      ИНАЧЕ
        ВЫРАЗИТЬ(УровниПодразделений.Департамент.Родитель.Родитель КАК Справочник.ПодразделенияОрганизаций).Родитель 
      КОНЕЦ          
ИНАЧЕ
    УровниПодразделений.Департамент 
КОНЕЦ КАК ОбособленноеПодразделение, 

ВЫБОР 
КОГДА УровниПодразделений.УровеньПодразделения.Наименование = &ГД ТОГДА
     УровниПодразделений.Подразделение     
КОГДА УровниПодразделений.УровеньРодителя.Наименование = &ГД1 ТОГДА
     УровниПодразделений.Департамент    
КОГДА УровниПодразделений.УровеньРодителя.Наименование = &ГД3 ТОГДА   
     ВЫБОР 
     КОГДА УровниПодразделений.УровеньПД.Наименование = &ГД1 ТОГДА
         ВЫРАЗИТЬ(УровниПодразделений.Департамент КАК Справочник.ПодразделенияОрганизаций).Родитель 
     КОГДА  ВЫРАЗИТЬ(УровниПодразделений.Департамент КАК Справочник.ПодразделенияОрганизаций).Родитель = &ГД ТОГДА   
         ВЫРАЗИТЬ(УровниПодразделений.Департамент КАК Справочник.ПодразделенияОрганизаций).Родитель 
     ИНАЧЕ
         ВЫРАЗИТЬ(УровниПодразделений.Департамент.Родитель КАК Справочник.ПодразделенияОрганизаций).Родитель  
     КОНЕЦ     
КОГДА  ВЫРАЗИТЬ(УровниПодразделений.Департамент КАК Справочник.ПодразделенияОрганизаций).Родитель = ЗНАЧЕНИЕ(Справочник.ПодразделенияОрганизаций.ПустаяСсылка) ТОГДА
     УровниПодразделений.Департамент 
    
ИНАЧЕ
     ВЫРАЗИТЬ(УровниПодразделений.Департамент КАК Справочник.ПодразделенияОрганизаций).Родитель 
КОНЕЦ КАК ПодразделениеДепартамент,         

ВЫБОР 
КОГДА УровниПодразделений.УровеньПодразделения.Наименование = &ГД ТОГДА
     УровниПодразделений.Подразделение 
КОГДА УровниПодразделений.УровеньПодразделения.Наименование = &ГД2 ТОГДА  
      УровниПодразделений.Подразделение   
КОГДА   УровниПодразделений.УровеньРодителя.Наименование = &ГД3 ТОГДА    
        ВЫРАЗИТЬ(УровниПодразделений.Департамент КАК Справочник.ПодразделенияОрганизаций).Родитель   
           
ИНАЧЕ УровниПодразделений.Департамент 

КОНЕЦ КАК ДепартаментНаправление, 
 
ВЫБОР 
КОГДА УровниПодразделений.УровеньПодразделения.Наименование = &ГД3
ИЛИ УровниПодразделений.УровеньПодразделения.Наименование = &ГД2 ТОГДА  
УровниПодразделений.Подразделение  
КОГДА  УровниПодразделений.УровеньПодразделения.Наименование = &ГД ТОГДА
     УровниПодразделений.Подразделение
ИНАЧЕ УровниПодразделений.Департамент 
КОНЕЦ КАК ОтделСлужба, 
УровниПодразделений.Подразделение КАК ГруппаСлужба

ПОМЕСТИТЬ ИерархияПодразделения
ИЗ УровниПодразделений КАК УровниПодразделений  
;
ВЫБРАТЬ 
Коэффициенты.Сотрудник,
Коэффициенты.ДатаНачала,
Коэффициенты.ДатаОкончания,
Коэффициенты.Организация,
Коэффициенты.Показатель,
Коэффициенты.Значение,
Коэффициенты.ДействуетДо,
"Совмещение"  КАК ДляКомментария
ПОМЕСТИТЬ СовмещениеСотрудника
ИЗ РегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковИнтервальный КАК Коэффициенты  
ГДЕ Коэффициенты.Сотрудник В (ВЫБРАТЬ СотрудникиОтбора.Сотрудник ИЗ СотрудникиОтбора КАК СотрудникиОтбора)     
И  Коэффициенты.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиРасчетаЗарплаты.РазмерДоплатыЗаСовмещение)  
И (Коэффициенты.ДатаНачала МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ) 
ИЛИ Коэффициенты.ДатаОкончания МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ))
ОБЪЕДИНИТЬ ВСЕ     
ВЫБРАТЬ 
Коэффициенты.Сотрудник,
Коэффициенты.ДатаНачала,
Коэффициенты.ДатаОкончания,
Коэффициенты.Организация,
Коэффициенты.Показатель,
Коэффициенты.Значение,
Коэффициенты.ДействуетДо,
"Оклад"  КАК ДляКомментария
//ПОМЕСТИТЬ ОкладСотрудника
ИЗ РегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковИнтервальный КАК Коэффициенты  
ГДЕ Коэффициенты.Сотрудник В (ВЫБРАТЬ СотрудникиОтбора.Сотрудник ИЗ СотрудникиОтбора КАК СотрудникиОтбора)     
И  Коэффициенты.Показатель.Наименование = &ОкладПоДням
И (Коэффициенты.ДатаНачала МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ) 
ИЛИ Коэффициенты.ДатаОкончания МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ))
;       
ВЫБРАТЬ 
Коэффициенты.Сотрудник,
Коэффициенты.ДатаНачала,
Коэффициенты.ДатаОкончания,
Коэффициенты.Организация,
Коэффициенты.Показатель,
Коэффициенты.Значение,
Коэффициенты.ДействуетДо,
"Совмещение"  КАК ДляКомментария
ПОМЕСТИТЬ РКСотрудника
ИЗ РегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковИнтервальный КАК Коэффициенты  
ГДЕ Коэффициенты.Сотрудник В (ВЫБРАТЬ СотрудникиОтбора.Сотрудник ИЗ СотрудникиОтбора КАК СотрудникиОтбора)     
И  Коэффициенты.Показатель = ЗНАЧЕНИЕ(Справочник.ПоказателиРасчетаЗарплаты.РайонныйКоэффициент)  
И (Коэффициенты.ДатаНачала МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаН,ДЕНЬ) И КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ) 
ИЛИ Коэффициенты.ДатаОкончания > КОНЕЦПЕРИОДА(&ДатаК,ДЕНЬ))

;  
ВЫБРАТЬ 
СевернаяНадбавка.ФизическоеЛицо,    
СотрудникиОтбора.Сотрудник,
СевернаяНадбавка.ПроцентСевернойНадбавки,
СевернаяНадбавка.ДействуетДо
ПОМЕСТИТЬ СНСотрудника
ИЗ РегистрСведений.ПроцентыСевернойНадбавкиФизическихЛиц.СрезПоследних(&ДатаК,ФизическоеЛицо В (ВЫБРАТЬ СотрудникиОтбора.ФизическоеЛицо ИЗ СотрудникиОтбора КАК СотрудникиОтбора)) КАК СевернаяНадбавка     
ЛЕВОЕ СОЕДИНЕНИЕ СотрудникиОтбора КАК СотрудникиОтбора ПО СотрудникиОтбора.ФизическоеЛицо =    СевернаяНадбавка.ФизическоеЛицо
ГДЕ СевернаяНадбавка.ФизическоеЛицо В (ВЫБРАТЬ СотрудникиОтбора.ФизическоеЛицо ИЗ СотрудникиОтбора КАК СотрудникиОтбора)     
;
ВЫБРАТЬ      
СотрудникиОтбора.Сотрудник,  
СотрудникиОтбора.Организация,
СостоянияСотрудников.Состояние КАК ТекущийСтатус,
ЕСТЬNULL(СовмещениеСотрудника.ДляКомментария,NULL) КАК Комментарий,
СотрудникиОтбора.ТабельныйНомер КАК ТабельныйНомер,  
ИерархияПодразделения.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
ИерархияПодразделения.ПодразделениеДепартамент КАК ПодразделениеДепартамент,
ИерархияПодразделения.ДепартаментНаправление КАК ДепартаментНаправление, 
ИерархияПодразделения.ОтделСлужба КАК ОтделСлужба,   
ИерархияПодразделения.ГруппаСлужба КАК ГруппаТН_Направление,     
ОтработанновеВремяВДолжности.Должность КАК Должность,
ОтработанновеВремяВДолжности.ДатаНачала КАК ДатаПриема,
ЕСТЬNULL(РАЗНОСТЬДАТ(ОтработанновеВремяВДолжности.ДатаНачала,ИспытательныйСрок.ДатаЗавершения,ДЕНЬ),0) КАК ИС,
ЕСТЬNULL(ИспытательныйСрок.ДатаЗавершения,NULL) КАК ДатаОкончанияИС,
ДАТАВРЕМЯ(1,1,1) КАК ДатаНачалаБИР,
ДАТАВРЕМЯ(1,1,1) КАК ДатаОкончанияБИР,
ДАТАВРЕМЯ(1,1,1) КАК ДатаНачалаПоУходуЗаРебенком,     
ДАТАВРЕМЯ(1,1,1) КАК ОкончанияПоУходуЗаРебенком,  
РабочиеДниПериода.КоличествоРабочиДнейПериода КАК КоличествоДнейВПериодеРасчета, 
ВЫБОР КОГДА РабочиеДниПериода.КоличествоРабочиДнейПериода < ОтработанновеВремяВДолжности.ОтработаноДней ТОГДА
 РабочиеДниПериода.КоличествоРабочиДнейПериода
 ИНАЧЕ
ОтработанновеВремяВДолжности.ОтработаноДней
КОНЕЦ 
КАК ОтработаноДней,
ОтработанновеВремяВДолжности.ОтработаноДней КАК КолДнейДляРасчета,
ШтатноеРасписаниеСотрудников.ОкладТариф КАК ОкладПоПолнойСтавке,
ОтработанновеВремяВДолжности.КоличествоСтавок КАК КоличествоСтавок ,
ШтатноеРасписаниеСотрудников.ОкладТариф*ОтработанновеВремяВДолжности.КоличествоСтавок КАК СреднийОклад,    
ЕСТЬNULL(СНСотрудника.ПроцентСевернойНадбавки/100,0) + ЕСТЬNULL(РКСотрудника.Значение,1) КАК РК_СН,
0 КАК СреднийОкладСРегиональнымиКоэффициентами,
ШтатноеРасписаниеСотрудников.ПремияОбщая КАК ПроцентПремии,
100 КАК KPI_МаксимальныйПроцент,
0 КАК ИтогоПремияПоПриказу,
0 КАК ИтогоПремяС_РК_СН,
0 КАК Разницв_ПО_РК_СН                     
ПОМЕСТИТЬ ДанныеОтчета
ИЗ СотрудникиОтбора КАК СотрудникиОтбора

ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОтработанновеВремяВДолжности КАК ОтработанновеВремяВДолжности ПО ОтработанновеВремяВДолжности.Сотрудник = СотрудникиОтбора.Сотрудник
ЛЕВОЕ СОЕДИНЕНИЕ ШтатноеРасписаниеСотрудников КАК ШтатноеРасписаниеСотрудников ПО ШтатноеРасписаниеСотрудников.Ссылка = ОтработанновеВремяВДолжности.ДолжностьПоШтатномуРасписанию      
ЛЕВОЕ СОЕДИНЕНИЕ ИспытательныйСрок КАК ИспытательныйСрок ПО 
ИспытательныйСрок.Сотрудник = СотрудникиОтбора.Сотрудник И ИспытательныйСрок.Организация = СотрудникиОтбора.Организация 
И ИспытательныйСрок.ДатаЗавершения > ОтработанновеВремяВДолжности.ДатаОкончания 
ЛЕВОЕ СОЕДИНЕНИЕ СостоянияСотрудников КАК СостоянияСотрудников ПО СостоянияСотрудников.Сотрудник = СотрудникиОтбора.Сотрудник     
ЛЕВОЕ СОЕДИНЕНИЕ ИерархияПодразделения КАК ИерархияПодразделения ПО ИерархияПодразделения.ГруппаСлужба =  ШтатноеРасписаниеСотрудников.Подразделение
ЛЕВОЕ СОЕДИНЕНИЕ РабочиеДниПериода КАК РабочиеДниПериода ПО РабочиеДниПериода.ПериодЗапроса = СотрудникиОтбора.ПериодЗапроса     
ЛЕВОЕ СОЕДИНЕНИЕ СовмещениеСотрудника КАК СовмещениеСотрудника ПО СовмещениеСотрудника.Сотрудник = СотрудникиОтбора.Сотрудник  
 И СовмещениеСотрудника.Организация = СотрудникиОтбора.Организация          
 ЛЕВОЕ СОЕДИНЕНИЕ СНСотрудника КАК СНСотрудника ПО СНСотрудника.Сотрудник = СотрудникиОтбора.Сотрудник  
 ЛЕВОЕ СОЕДИНЕНИЕ РКСотрудника КАК РКСотрудника ПО РКСотрудника.Сотрудник = СотрудникиОтбора.Сотрудник  
;
ВЫБРАТЬ     
ДанныеОтчета.Сотрудник,  
ДанныеОтчета.Организация,
ДанныеОтчета.ТекущийСтатус,
ДанныеОтчета.Комментарий,
ДанныеОтчета.ТабельныйНомер,  
ДанныеОтчета.ОбособленноеПодразделение,
ДанныеОтчета.ПодразделениеДепартамент,
ДанныеОтчета.ДепартаментНаправление, 
ДанныеОтчета.ОтделСлужба,   
ДанныеОтчета.ГруппаТН_Направление,     
ДанныеОтчета.Должность,
ДанныеОтчета.ДатаПриема,
ДанныеОтчета.ИС,
ДанныеОтчета.ДатаОкончанияИС,
ДанныеОтчета.ДатаНачалаБИР,
ДанныеОтчета.ДатаОкончанияБИР,
ДанныеОтчета.ДатаНачалаПоУходуЗаРебенком,     
ДанныеОтчета.ОкончанияПоУходуЗаРебенком,   
ДанныеОтчета.КоличествоДнейВПериодеРасчета,
ВЫБОР КОГДА ДанныеОтчета.ИС > ДанныеОтчета.КолДнейДляРасчета ТОГДА
 0
ИНАЧЕ
 ДанныеОтчета.КолДнейДляРасчета-ДанныеОтчета.ИС 
КОНЕЦ КАК КолДнейДляРасчета,
ДанныеОтчета.ОтработаноДней,   
ДанныеОтчета.ОкладПоПолнойСтавке,
ДанныеОтчета.КоличествоСтавок ,
ДанныеОтчета.СреднийОклад,
ДанныеОтчета.РК_СН,
ДанныеОтчета.СреднийОклад *ДанныеОтчета.РК_СН КАК СреднийОкладСРегиональнымиКоэффициентами,
ДанныеОтчета.ПроцентПремии,        
ДанныеОтчета.СреднийОклад*ВЫРАЗИТЬ(ДанныеОтчета.ПроцентПремии КАК Число(3)) / 100 КАК СумммаПолнойПремии,
ДанныеОтчета.KPI_МаксимальныйПроцент,        
0 КАК ИтогоПремияПоПриказу,
ДанныеОтчета.ИтогоПремяС_РК_СН,
ДанныеОтчета.Разницв_ПО_РК_СН   
ПОМЕСТИТЬ ДанныеРасчета
ИЗ  ДанныеОтчета КАК ДанныеОтчета       
;
ВЫБРАТЬ     
ДанныеРасчета.Сотрудник,  
ДанныеРасчета.Организация,
ДанныеРасчета.ТекущийСтатус,
ВЫБОР КОГДА ДанныеРасчета.ИС = 0 ТОГДА    
ДанныеРасчета.Комментарий   
ИНАЧЕ  "Испытательный срок" КОНЕЦ
КАК Комментарий,
ДанныеРасчета.ТабельныйНомер,  
ДанныеРасчета.ОбособленноеПодразделение,
ДанныеРасчета.ПодразделениеДепартамент,
ДанныеРасчета.ДепартаментНаправление, 
ДанныеРасчета.ОтделСлужба,   
ДанныеРасчета.ГруппаТН_Направление,     
ДанныеРасчета.Должность,
ДанныеРасчета.ДатаПриема,
ДанныеРасчета.ИС,
ДанныеРасчета.ДатаОкончанияИС,
ДанныеРасчета.ДатаНачалаБИР,
ДанныеРасчета.ДатаОкончанияБИР,
ДанныеРасчета.ДатаНачалаПоУходуЗаРебенком,     
ДанныеРасчета.ОкончанияПоУходуЗаРебенком,   
ДанныеРасчета.КоличествоДнейВПериодеРасчета,      
ДанныеРасчета.КолДнейДляРасчета,
ДанныеРасчета.КолДнейДляРасчета / ДанныеРасчета.КоличествоДнейВПериодеРасчета*100 КАК ПроцентРасчета,    
ДанныеРасчета.СумммаПолнойПремии,
ДанныеРасчета.ОтработаноДней,   
ДанныеРасчета.ОкладПоПолнойСтавке,
ДанныеРасчета.КоличествоСтавок ,
ДанныеРасчета.СреднийОклад,
ДанныеРасчета.РК_СН,
ДанныеРасчета.СреднийОкладСРегиональнымиКоэффициентами,
ДанныеРасчета.ПроцентПремии,        
ДанныеРасчета.KPI_МаксимальныйПроцент,        
0 КАК ИтогоПремияПоПриказу,
ДанныеРасчета.СреднийОкладСРегиональнымиКоэффициентами*ВЫРАЗИТЬ(ДанныеРасчета.ПроцентПремии КАК Число(3)) / 100 КАК ИтогоПремяС_РК_СН,
ДанныеРасчета.Разницв_ПО_РК_СН 
ПОМЕСТИТЬ РасчетыПремий  
ИЗ  ДанныеРасчета КАК ДанныеРасчета
;  
ВЫБРАТЬ     
РасчетыПремий.Сотрудник,  
РасчетыПремий.Организация,
РасчетыПремий.ТекущийСтатус,
РасчетыПремий.Комментарий,
РасчетыПремий.ТабельныйНомер,  
РасчетыПремий.ОбособленноеПодразделение,
РасчетыПремий.ПодразделениеДепартамент,
РасчетыПремий.ДепартаментНаправление, 
РасчетыПремий.ОтделСлужба,   
РасчетыПремий.ГруппаТН_Направление,     
РасчетыПремий.Должность,
РасчетыПремий.ДатаПриема,
РасчетыПремий.ИС,
РасчетыПремий.ДатаОкончанияИС,
РасчетыПремий.ДатаНачалаБИР,
РасчетыПремий.ДатаОкончанияБИР,
РасчетыПремий.ДатаНачалаПоУходуЗаРебенком,     
РасчетыПремий.ОкончанияПоУходуЗаРебенком,   
РасчетыПремий.КоличествоДнейВПериодеРасчета,  
РасчетыПремий.КолДнейДляРасчета ,
РасчетыПремий.ПроцентРасчета,    
РасчетыПремий.ОтработаноДней,   
РасчетыПремий.ОкладПоПолнойСтавке,
РасчетыПремий.КоличествоСтавок ,
РасчетыПремий.СреднийОклад,
РасчетыПремий.РК_СН,
РасчетыПремий.СреднийОкладСРегиональнымиКоэффициентами,
РасчетыПремий.ПроцентПремии,        
РасчетыПремий.СумммаПолнойПремии,
РасчетыПремий.KPI_МаксимальныйПроцент,        
РасчетыПремий.СумммаПолнойПремии * РасчетыПремий.ПроцентРасчета /100 КАК ИтогоПремияПоПриказу,
РасчетыПремий.СреднийОкладСРегиональнымиКоэффициентами* ВЫРАЗИТЬ(РасчетыПремий.ПроцентПремии КАК Число(15,2)) /100  КАК ИтогоПремяС_РК_СН,
РасчетыПремий.Разницв_ПО_РК_СН     
ПОМЕСТИТЬ ВыводДанныхОтчета
ИЗ  РасчетыПремий КАК РасчетыПремий     
;  
ВЫБРАТЬ 
ВыводДанныхОтчета.Сотрудник,  
ВыводДанныхОтчета.Организация,
ВыводДанныхОтчета.ТекущийСтатус,
ВыводДанныхОтчета.Комментарий,
ВыводДанныхОтчета.ТабельныйНомер,  
ВыводДанныхОтчета.ОбособленноеПодразделение,
ВыводДанныхОтчета.ПодразделениеДепартамент,
ВыводДанныхОтчета.ДепартаментНаправление, 
ВыводДанныхОтчета.ОтделСлужба,   
ВыводДанныхОтчета.ГруппаТН_Направление,     
ВыводДанныхОтчета.Должность,
ВыводДанныхОтчета.ДатаПриема,
ВыводДанныхОтчета.ИС,
ВыводДанныхОтчета.ДатаОкончанияИС,
ВыводДанныхОтчета.ДатаНачалаБИР,
ВыводДанныхОтчета.ДатаОкончанияБИР,
ВыводДанныхОтчета.ДатаНачалаПоУходуЗаРебенком,     
ВыводДанныхОтчета.ОкончанияПоУходуЗаРебенком,   
ВыводДанныхОтчета.КоличествоДнейВПериодеРасчета,  
ВыводДанныхОтчета.КолДнейДляРасчета ,
ВыводДанныхОтчета.ПроцентРасчета,    
ВыводДанныхОтчета.ОтработаноДней,   
ВыводДанныхОтчета.ОкладПоПолнойСтавке,
ВыводДанныхОтчета.КоличествоСтавок ,
ВыводДанныхОтчета.СреднийОклад,
ВыводДанныхОтчета.РК_СН,
ВыводДанныхОтчета.СреднийОкладСРегиональнымиКоэффициентами,
ВыводДанныхОтчета.ПроцентПремии,        
ВыводДанныхОтчета.СумммаПолнойПремии,
ВыводДанныхОтчета.KPI_МаксимальныйПроцент,        
ВЫРАЗИТЬ(ВыводДанныхОтчета.ИтогоПремияПоПриказу КАК Число(15,2)) КАК ИтогоПремияПоПриказу,
ВыводДанныхОтчета.ИтогоПремяС_РК_СН,
ВЫБОР КОГДА ВыводДанныхОтчета.ИтогоПремяС_РК_СН >0 ТОГДА 
 ВыводДанныхОтчета.ИтогоПремяС_РК_СН - ВыводДанныхОтчета.ИтогоПремияПоПриказу
ИНАЧЕ 0 КОНЕЦ КАК Разницв_ПО_РК_СН     
ПОМЕСТИТЬ ВыводДанныхОтчета1
ИЗ  ВыводДанныхОтчета КАК ВыводДанныхОтчета   
;     
ВЫБРАТЬ  ПЕРВЫЕ 1000000   
ВыводДанныхОтчета1.Сотрудник,  
ВыводДанныхОтчета1.Организация,
ВыводДанныхОтчета1.ТекущийСтатус,
ВыводДанныхОтчета1.Комментарий,
ВыводДанныхОтчета1.ТабельныйНомер,  
ВыводДанныхОтчета1.ОбособленноеПодразделение,
ВыводДанныхОтчета1.ПодразделениеДепартамент,
ВыводДанныхОтчета1.ДепартаментНаправление, 
ВыводДанныхОтчета1.ОтделСлужба,   
ВыводДанныхОтчета1.ГруппаТН_Направление,     
ВыводДанныхОтчета1.Должность,
ВыводДанныхОтчета1.ДатаПриема,
ВыводДанныхОтчета1.ИС,
ВыводДанныхОтчета1.ДатаОкончанияИС,
ВыводДанныхОтчета1.ДатаНачалаБИР,
ВыводДанныхОтчета1.ДатаОкончанияБИР,
ВыводДанныхОтчета1.ДатаНачалаПоУходуЗаРебенком,     
ВыводДанныхОтчета1.ОкончанияПоУходуЗаРебенком,   
ВыводДанныхОтчета1.КоличествоДнейВПериодеРасчета,  
ВыводДанныхОтчета1.КолДнейДляРасчета ,
ВыводДанныхОтчета1.ПроцентРасчета,    
ВыводДанныхОтчета1.ОтработаноДней,   
ВыводДанныхОтчета1.ОкладПоПолнойСтавке,
ВыводДанныхОтчета1.КоличествоСтавок ,
ВыводДанныхОтчета1.СреднийОклад,
ВыводДанныхОтчета1.РК_СН,
ВыводДанныхОтчета1.СреднийОкладСРегиональнымиКоэффициентами,
ВыводДанныхОтчета1.ПроцентПремии,        
ВыводДанныхОтчета1.СумммаПолнойПремии,
ВыводДанныхОтчета1.KPI_МаксимальныйПроцент,        
ВыводДанныхОтчета1.ИтогоПремияПоПриказу,
ВыводДанныхОтчета1.ИтогоПремяС_РК_СН,
ВЫРАЗИТЬ(ВыводДанныхОтчета1.Разницв_ПО_РК_СН КАК Число(15,2))КАК Разницв_ПО_РК_СН
   
ИЗ  ВыводДанныхОтчета1 КАК ВыводДанныхОтчета1   
УПОРЯДОЧИТЬ ПО 
ВыводДанныхОтчета1.Сотрудник.Наименование ВОЗР
