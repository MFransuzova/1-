ВЫБРАТЬ
Рег.Номенклатура,
Рег.Склад,
Рег.Серия,
Рег.ВНаличииОстаток,
Рег.КОтгрузкеОстаток
ПОМЕСТИТЬ ОстаткиНаСкладах
ИЗ РегистрНакопления.ТоварыНаСкладах.Остатки(&НаДату) КАК Рег
ГДЕ Рег.Склад = &Склад
;
ВЫБРАТЬ
Рег.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
Рег.АналитикаУчетаНоменклатуры.Серия КАК Серия,
Рег.АналитикаУчетаНоменклатуры.МестоХранения КАК Склад,
Рег.Организация,
Рег.КоличествоОстаток,
Рег.КОформлениюСписанияОстаток
ПОМЕСТИТЬ ОстаткиОрганизации
ИЗ РегистрНакопления.ТоварыОрганизаций.Остатки(&НаДату) КАК Рег
ГДЕ Рег.Организация = &Организация
И Рег.АналитикаУчетаНоменклатуры.МестоХранения = &Склад
;
ВЫБРАТЬ
ОстаткиНаСкладах.Номенклатура,
ОстаткиНаСкладах.Склад,
ОстаткиНаСкладах.Серия,
ОстаткиНаСкладах.ВНаличииОстаток,
ОстаткиНаСкладах.КОтгрузкеОстаток
ПОМЕСТИТЬ ОстаткиНаСкладахНеОформлены
ИЗ ОстаткиНаСкладах КАК ОстаткиНаСкладах
ГДЕ (ОстаткиНаСкладах.Номенклатура,ОстаткиНаСкладах.Склад,ОстаткиНаСкладах.Серия) НЕ В (ВЫБРАТЬ ОстаткиОрганизации.Номенклатура,ОстаткиОрганизации.Склад,ОстаткиОрганизации.Серия ИЗ ОстаткиОрганизации КАК ОстаткиОрганизации)
;
ВЫБРАТЬ 
Рег1.Склад,
Рег1.Номенклатура,
Рег1.Серия,
Рег1.ВНаличииОстаток,
NULL КАК Организация,
NULL КАК КоличествоОстаток,
NULL КАК Разница
ПОМЕСТИТЬ НаСкладахНаОрганизации

ИЗ ОстаткиНаСкладахНеОформлены КАК Рег1
ОБЪЕДИНИТЬ ВСЕ
ВЫБРАТЬ
ОстаткиНаСкладах.Склад,
ОстаткиНаСкладах.Номенклатура,
ОстаткиНаСкладах.Серия,
ОстаткиНаСкладах.ВНаличииОстаток,
ОстаткиОрганизации.Организация,
ОстаткиОрганизации.КоличествоОстаток,
ОстаткиНаСкладах.ВНаличииОстаток - ОстаткиОрганизации.КоличествоОстаток КАК Разница 
ИЗ ОстаткиНаСкладах КАК ОстаткиНаСкладах
ЛЕВОЕ СОЕДИНЕНИЕ ОстаткиОрганизации КАК ОстаткиОрганизации ПО 
ОстаткиОрганизации.Номенклатура = ОстаткиНаСкладах.Номенклатура И 
ОстаткиОрганизации.Склад = ОстаткиНаСкладах.Склад И 
ОстаткиОрганизации.Серия = ОстаткиНаСкладах.Серия 
ГДЕ (ОстаткиНаСкладах.Номенклатура,ОстаткиНаСкладах.Склад,ОстаткиНаСкладах.Серия) НЕ В (ВЫБРАТЬ ОстаткиНаСкладахНеОформлены.Номенклатура,ОстаткиНаСкладахНеОформлены.Склад,ОстаткиНаСкладахНеОформлены.Серия ИЗ ОстаткиНаСкладахНеОформлены КАК ОстаткиНаСкладахНеОформлены)
;
ВЫБРАТЬ
Рег.Номенклатура,
Рег.Склад,
Рег.ВНаличииОстаток,
Рег.ВРезервеСоСкладаОстаток,
Рег.ВРезервеПодЗаказОстаток
ПОМЕСТИТЬ СвободныеОстатки
ИЗ РегистрНакопления.СвободныеОстатки.Остатки(&НаДату) КАК Рег
ГДЕ Рег.Склад = &Склад
;
ВЫБРАТЬ
Выборка.Склад,
Выборка.Номенклатура,
Выборка.Серия,
ВЫРАЗИТЬ(Выборка.ВНаличииОстаток КАК Число(15,3)) КАК ОстатокПоСкладам,
Выборка.Организация,
Выборка.КоличествоОстаток КАК ОстатокПоОрганизации,
Выборка.Разница КАК РазницаПоСкладамИОрганизациям
//СвободныеОстатки.ВНаличииОстаток КАК СвободныеОстатки
ПОМЕСТИТЬ РасхожденияПОСкладуИОрганизации
ИЗ НаСкладахНаОрганизации КАК Выборка
//УПОРЯДОЧИТЬ ПО Выборка.Номенклатура.Наименование ВОЗР
//ЛЕВОЕ СОЕДИНЕНИЕ СвободныеОстатки КАК СвободныеОстатки ПО СвободныеОстатки.Номенклатура = Выборка.Номенклатура И СвободныеОстатки.Склад = Выборка.Склад
;
ВЫБРАТЬ
СвернутаВыборка.Склад,
СвернутаВыборка.Номенклатура,
СУММА(СвернутаВыборка.ОстатокПоСкладам) КАК ОстаткиПоСкладам  
ПОМЕСТИТЬ ОстаткиСвернуты
ИЗ РасхожденияПОСкладуИОрганизации КАК СвернутаВыборка
СГРУППИРОВАТЬ ПО 
СвернутаВыборка.Склад,
СвернутаВыборка.Номенклатура
;
ВЫБРАТЬ
ОстаткиСвернуты.Склад,
ОстаткиСвернуты.Номенклатура,
ОстаткиСвернуты.ОстаткиПоСкладам,
СвободныеОстатки.ВНаличииОстаток КАК СвободныйОстаток,
ОстаткиСвернуты.ОстаткиПоСкладам - СвободныеОстатки.ВНаличииОстаток КАК РазницаСвободногоОстатка
ИЗ ОстаткиСвернуты КАК ОстаткиСвернуты
ЛЕВОЕ СОЕДИНЕНИЕ СвободныеОстатки КАК СвободныеОстатки ПО СвободныеОстатки.Номенклатура = ОстаткиСвернуты.Номенклатура И СвободныеОстатки.Склад = ОстаткиСвернуты.Склад
УПОРЯДОЧИТЬ ПО ОстаткиСвернуты.Номенклатура.Наименование ВОЗР

