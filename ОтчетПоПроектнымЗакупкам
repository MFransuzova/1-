ВЫБРАТЬ РАЗЛИЧНЫЕ РАЗРЕШЕННЫЕ
КураторыД.Куратор.Ссылка КАК КураторЗакупок,
КураторыД.Куратор.Наименование КАК ИмяКуратора  
ПОМЕСТИТЬ Кураторы
ИЗ РегистрСведений.ГАС_КураторыЗакупок КАК КураторыД
ГДЕ НЕ КураторыД.Куратор = ЗНАЧЕНИЕ(Справочник.РолиИсполнителей.ДПП)
//ГДЕ ТИПЗНАЧЕНИЯ(КураторыД.Куратор) = ТИП(Справочник.Пользователи)
//И НЕ КураторыД.Куратор = NULL
;
ВЫБРАТЬ  РАЗРЕШЕННЫЕ
СвойстваСС.ПозицияСС КАК ПозицияСС,
СвойстваСС.ПозицияСС.КомплектРД КАК КомплектРД
ПОМЕСТИТЬ СвойстваСС
ИЗ РегистрСведений.ГАС_СвойстваПозицииСС.СрезПоследних КАК СвойстваСС
//ГДЕ СвойстваСС.ПозицияСС = &СС
//ГДЕ СвойстваСС.ПозицияСС.КомплектРД В ИЕРАРХИИ(&СС)
;
ВЫБРАТЬ РАЗРЕШЕННЫЕ
КураторыЗакупок.Период,
КураторыЗакупок.Регистратор,
КураторыЗакупок.ПозицияСС,
КураторыЗакупок.Куратор  КАК КураторЗакупок
ПОМЕСТИТЬ КураторыЗакупок
ИЗ РегистрСведений.ГАС_КураторыЗакупок КАК КураторыЗакупок
ГДЕ КураторыЗакупок.ПозицияСС в (ВЫБРАТЬ СвойстваСС.ПозицияСС ИЗ СвойстваСС КАК СвойстваСС)
;
ВЫБРАТЬ РАЗРЕШЕННЫЕ
СрезПоСС.Период,
СрезПоСС.Документ,
ТИПЗНАЧЕНИЯ(СрезПоСС.Документ),
СрезПоСС.Статус,
СрезПоСС.Ответственный,
КураторыЗакупок.ПозицияСС КАК ПозицияСС
ПОМЕСТИТЬ СтатусыСертификатов
ИЗ  КураторыЗакупок КАК КураторыЗакупок
ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГАС_СтатусыОбъектов КАК СрезПоСС   ПО  СрезПоСС.Документ = КураторыЗакупок.Регистратор
ГДЕ КураторыЗакупок.ПозицияСС  в (ВЫБРАТЬ СвойстваСС.ПозицияСС ИЗ СвойстваСС КАК СвойстваСС)
  И СрезПоСС.Статус = ЗНАЧЕНИЕ(Перечисление.СтатусыПланов.Утвержден)
  И  СрезПоСС.Документ ССЫЛКА Документ.УСОERP_РазделительнаяВедомость
;
ВЫБРАТЬ РАЗРЕШЕННЫЕ
//ПЕРВЫЕ 1000
//Рег.ПозицияСС,
СвойстваСС.ПозицияСС КАК ПозицияСС,
ПозицияССНомерКВ КАК НомерКВ,  
Рег.Отложено,
ВЫРАЗИТЬ(Рег.Поставщик КАК Строка) КАК Закупщик,
Рег.МО КАК МатОтбор,
Рег.Проект КАК Проект,
Рег.ОбъектСтроительства КАК ОбъектСтроительства,
Рег.Подобъект КАК Подобъект,
СвойстваСС.ПозицияСС.КомплектРД КАК КомплектРД,
Рег.Работа КАК Работа,
ПроектНом.ПроектнаяНоменклатура КАК НаименованиеМТР,
СвойстваСС.АртикулНоменклатуры КАК Артикул,
Рег.ПроектныйПроизводитель КАК ПроектныйПроизводитель,
Рег.ПримечаниеДПП КАК ПримечаниеДПП,
Рег.КомментарийДК КАК КомментарийДК,
Рег.НачалоРаботы КАК НачалоРаботы,
Кураторы.КураторЗакупок КАК Куратор,
Статусы.Период КАК ДатаВыдачиДПП,  
Рег.ЕдиницаПоставки КАК ЕдИзм,
Рег.МассаЕдПоставки КАК МассаЕдПоставки,
Рег.МассаИтого КАК МассаИтого,
Рег.КолвоСС КАК КолвоСС,
Рег.КолвоКЗакупке КАК КолвоКЗакупке,
Рег.КолвоКЗакупке - Рег.ЗаявленоОборот КАК ОстатокКЗаказу,
NULL КАК КорректировкаНазначения,
NULL КАК СкладПерезакрепления,
NULL КАК ПрежняяПозицияСС,
NULL КАК ОбеспеченоИзНаличия, 
ВЫРАЗИТЬ(Рег.ЗаказПоставщику КАК Строка) КАК ЗаказПоставщику,
Рег.Контрагент КАК Поставщик,
Рег.Спецификация КАК СпецификацияПоДокументу,
Рег.ЗаявленоОборот КАК Заявлено,
Рег.ЗаказаноЗП КАК Заказано,
рег.Номенклатура КАК Номенклатура, 
рег.Код КАК Код,
Рег.СуммаЗП КАК СуммаСНДС,
Рег.КомментарийКЗаказу КАК КомментарийКЗаказу,
Рег.УведомлениеОбОтгрузке КАК УведомлениеОбОтгрузке,
Рег.ОтгруженоЗП КАК Отгружено,
Рег.НомерТС КАК НомерТС,
Рег.СуммаОПТ КАК СуммаСНДС1,  
Рег.ПТУ КАК ПТУ,
Рег.ПолученоЗП КАК Поступило,
Рег.СуммаПТУ КАК СуммаСНДС2,
Рег.КорректировкаРегистров КАК КорректировкаРегистров,
Рег.ЗаказаноКР КАК ЗаказаноК,
Рег.ОтгруженоКР КАК ОтгруженоК,
Рег.ПолученоКР КАК ПолученоК
ПОМЕСТИТЬ ИсполнениеПСС
ИЗ  РегистрСведений.ГАС_СвойстваПозицииСС.СрезПоследних КАК СвойстваСС
ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГАС_ИсполнениеПСС  КАК Рег   ПО СвойстваСС.ПозицияСС = Рег.ПозицияСС
ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ГАС_ПозицииСС КАК ПроектНом ПО  ПроектНом.Ссылка = Рег.ПозицияСС
ЛЕВОЕ СОЕДИНЕНИЕ Кураторы КАК Кураторы ПО Кураторы.ИмяКуратора ПОДОБНО  Рег.Куратор
ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ГАС_КураторыЗакупок.СрезПоследних КАК СрезПоСС ПО Кураторы.КураторЗакупок = СрезПоСС.Куратор И СрезПоСС.ПозицияСС = Рег.ПозицияСС
ЛЕВОЕ СОЕДИНЕНИЕ СтатусыСертификатов КАК Статусы ПО Статусы.ПозицияСС = СвойстваСС.ПозицияСС 

ГДЕ СвойстваСС.ПозицияСС   в (ВЫБРАТЬ СвойстваСС.ПозицияСС ИЗ СвойстваСС КАК СвойстваСС)

;

ВЫБРАТЬ  РАЗРЕШЕННЫЕ
РегОбеспечение.ПозицияСС,
//РегОбеспечение.Регистратор,
СУММА(РегОбеспечение.Запланировано) КАК Запланировано,
СУММА(РегОбеспечение.Обеспечено) КАК Обеспечено,
СУММА(РегОбеспечение.Запланировано - РегОбеспечение.Обеспечено) КАК ОбеспеченоИзНаличия
ПОМЕСТИТЬ Обеспечение
ИЗ РегистрНакопления.ГАСМатериалы КАК РегОбеспечение
ГДЕ   РегОбеспечение.Обеспечено > 0    
И РегОбеспечение.ПозицияСС  В (ВЫБРАТЬ ИсполнениеПСС.ПозицияСС ИЗ ИсполнениеПСС КАК ИсполнениеПСС)
СГРУППИРОВАТЬ ПО
РегОбеспечение.ПозицияСС
;
ВЫБРАТЬ  РАЗРЕШЕННЫЕ
ДокРегОбеспечение.ПозицияСС,
ДокРегОбеспечение.Регистратор КАК КорректировкаНазначения,
ВЫБОР КОГДА  ДокРегОбеспечение.Обеспечено > 0 ТОГДА
    ДокРегОбеспечение.Регистратор.Склад
ИНАЧЕ NULL КОНЕЦ КАК СкладПерезакрепления,
ДокРегОбеспечение.ПроектнаяНоменклатура,
ДокРегОбеспечение.ПрежняяПозицияСС,

СУММА(ДокРегОбеспечение.Запланировано) КАК Запланировано,
СУММА(ДокРегОбеспечение.Обеспечено) КАК Обеспечено,
СУММА(ДокРегОбеспечение.Запланировано - ДокРегОбеспечение.Обеспечено) КАК ОбеспеченоИзНаличия

ПОМЕСТИТЬ ДокиОбеспечения
ИЗ РегистрНакопления.ГАСМатериалы КАК ДокРегОбеспечение
ГДЕ   ДокРегОбеспечение.Обеспечено > 0    
И ДокРегОбеспечение.ПозицияСС  В (ВЫБРАТЬ ИсполнениеПСС.ПозицияСС ИЗ ИсполнениеПСС КАК ИсполнениеПСС)
СГРУППИРОВАТЬ ПО
ДокРегОбеспечение.ПозицияСС,
ДокРегОбеспечение.Регистратор,
ВЫБОР КОГДА  ДокРегОбеспечение.Обеспечено > 0 ТОГДА
    ДокРегОбеспечение.Регистратор.Склад
ИНАЧЕ NULL КОНЕЦ,
ДокРегОбеспечение.ПроектнаяНоменклатура,
ДокРегОбеспечение.ПрежняяПозицияСС

;

ВЫБРАТЬ  РАЗРЕШЕННЫЕ
Заказы.ПозицияСС,
КОЛИЧЕСТВО(Заказы.Ссылка) КоличествоЗаказов
ПОМЕСТИТЬ ЗаказыСтоимости
ИЗ Документ.ЗаказПоставщику.Спецификации  КАК Заказы
ГДЕ Заказы.Ссылка.Проведен И Заказы.ПозицияСС В (ВЫБРАТЬ ИсполнениеПСС.ПозицияСС ИЗ ИсполнениеПСС КАК ИсполнениеПСС)
СГРУППИРОВАТЬ ПО Заказы.ПозицияСС 
ИМЕЮЩИЕ КОЛИЧЕСТВО(Заказы.Ссылка) = 1
;   

ВЫБРАТЬ РАЗРЕШЕННЫЕ
Заказы.ПозицияСС,
Заказы.Ссылка,
Заказы.КомментарийДК,
СУММА(ТоварыЗаказа.Количество),
СУММА(ТоварыЗаказа.СуммаСНДС),
ВЫБОР КОГДА НЕ СУММА(ТоварыЗаказа.Количество) =0 Тогда
СУММА(ТоварыЗаказа.СуммаСНДС) / СУММА(ТоварыЗаказа.Количество) ИНАЧЕ 0 КОНЕЦ КАК СтоимостьСС
ПОМЕСТИТЬ Стоимость
ИЗ Документ.ЗаказПоставщику.Спецификации  КАК Заказы       
ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику.Товары КАК ТоварыЗаказа ПО  ТоварыЗаказа.Ссылка = Заказы.Ссылка  И  ТоварыЗаказа.ПроектнаяНоменклатура = Заказы.ПроектнаяНоменклатура
ГДЕ Заказы.ПозицияСС В (ВЫБРАТЬ ЗаказыСтоимости.ПозицияСС ИЗ ЗаказыСтоимости КАК ЗаказыСтоимости)
СГРУППИРОВАТЬ ПО 
Заказы.ПозицияСС,
Заказы.Ссылка,
Заказы.КомментарийДК

;
ВЫБРАТЬ
ИсполнениеПСС.ПозицияСС,
ИсполнениеПСС.НомерКВ,  
ИсполнениеПСС.Отложено,
ИсполнениеПСС.Закупщик,
ИсполнениеПСС.МатОтбор,
ИсполнениеПСС.Проект,
ИсполнениеПСС.ОбъектСтроительства,
ИсполнениеПСС.Подобъект,
ИсполнениеПСС.КомплектРД,
ИсполнениеПСС.Работа,
ИсполнениеПСС.НаименованиеМТР,
ИсполнениеПСС.Артикул,
ИсполнениеПСС.ПроектныйПроизводитель,
ИсполнениеПСС.ПримечаниеДПП,
ЕСТЬNULL(Стоимость.КомментарийДК,ИсполнениеПСС.КомментарийДК) КАК КомментарийДК,
ИсполнениеПСС.НачалоРаботы,
ИсполнениеПСС.Куратор,
ИсполнениеПСС.ДатаВыдачиДПП,  
ИсполнениеПСС.ЕдИзм,
ИсполнениеПСС.МассаЕдПоставки,
ИсполнениеПСС.МассаИтого,
ИсполнениеПСС.КолвоСС,
ИсполнениеПСС.КолвоКЗакупке,
ИсполнениеПСС.ОстатокКЗаказу,
ДокиОбеспечения.КорректировкаНазначения,
ДокиОбеспечения.СкладПерезакрепления,
ДокиОбеспечения.ПрежняяПозицияСС,
ЕСТЬNULL(ДокиОбеспечения.Обеспечено,0) КАК Обеспечено,
ВЫБОР КОГДА НЕ ДокиОбеспечения.ОбеспеченоИзНаличия < 0 ТОГДА
      ЕСТЬNULL(ДокиОбеспечения.Обеспечено,0)
ИНАЧЕ 0 КОНЕЦ КАК ОбеспеченоИзНаличия, 
ИсполнениеПСС.ЗаказПоставщику,
ИсполнениеПСС.Поставщик,
ИсполнениеПСС.СпецификацияПоДокументу,
ИсполнениеПСС.Заявлено,
ИсполнениеПСС.Заказано,
ИсполнениеПСС.Номенклатура, 
ИсполнениеПСС.Код,
ИсполнениеПСС.СуммаСНДС,
ИсполнениеПСС.КомментарийКЗаказу,
ИсполнениеПСС.УведомлениеОбОтгрузке,
ИсполнениеПСС.Отгружено,
ИсполнениеПСС.НомерТС,
ИсполнениеПСС.СуммаСНДС1,
ИсполнениеПСС.ПТУ,
ИсполнениеПСС.Поступило,
ИсполнениеПСС.СуммаСНДС2,
ИсполнениеПСС.КорректировкаРегистров,
ИсполнениеПСС.ЗаказаноК,
ИсполнениеПСС.ОтгруженоК,
ИсполнениеПСС.ПолученоК,
ВЫРАЗИТЬ(ЕСТЬNULL(Стоимость.СтоимостьСС*ЕСТЬNULL(ДокиОбеспечения.Обеспечено,0),0) КАК Число(15.2))  КАК НаСумму
ПОМЕСТИТЬ ДанныеПСС  
ИЗ ИсполнениеПСС  КАК ИсполнениеПСС
ЛЕВОЕ СОЕДИНЕНИЕ ДокиОбеспечения КАК ДокиОбеспечения ПО ДокиОбеспечения.ПозицияСС = ИсполнениеПСС.ПозицияСС
ЛЕВОЕ СОЕДИНЕНИЕ Стоимость КАК Стоимость ПО Стоимость.ПозицияСС = ИсполнениеПСС.ПозицияСС
//ГДЕ ИсполнениеПСС.Куратор = &Куратор
;
ВЫБРАТЬ
ДанныеПСС.ПозицияСС,
ДанныеПСС.НомерКВ,  
ДанныеПСС.Отложено,
ДанныеПСС.Закупщик,
ДанныеПСС.МатОтбор,
ДанныеПСС.Проект,
ДанныеПСС.ОбъектСтроительства,
ДанныеПСС.Подобъект,
ДанныеПСС.КомплектРД,
ДанныеПСС.Работа,
ДанныеПСС.НаименованиеМТР,
ДанныеПСС.Артикул,
ДанныеПСС.ПроектныйПроизводитель,
ДанныеПСС.ПримечаниеДПП,
ДанныеПСС.КомментарийДК,
ДанныеПСС.НачалоРаботы,
ДанныеПСС.Куратор,
ДанныеПСС.ДатаВыдачиДПП,  
ДанныеПСС.ЕдИзм,
ДанныеПСС.МассаЕдПоставки,
ДанныеПСС.МассаИтого,
ДанныеПСС.КолвоСС,
ДанныеПСС.КолвоКЗакупке,
ДанныеПСС.ОстатокКЗаказу,
ДанныеПСС.КорректировкаНазначения,
ДанныеПСС.СкладПерезакрепления,
ДанныеПСС.ПрежняяПозицияСС,
ДанныеПСС.Обеспечено,
ДанныеПСС.ОбеспеченоИзНаличия, 
ДанныеПСС.ЗаказПоставщику,
ДанныеПСС.Поставщик,
ДанныеПСС.СпецификацияПоДокументу,
ДанныеПСС.Заявлено,
ДанныеПСС.Заказано,
ДанныеПСС.Номенклатура, 
ДанныеПСС.Код,
ДанныеПСС.СуммаСНДС,
ДанныеПСС.КомментарийКЗаказу,
ДанныеПСС.УведомлениеОбОтгрузке,
ДанныеПСС.Отгружено,
ДанныеПСС.НомерТС,
ДанныеПСС.СуммаСНДС1,
ДанныеПСС.ПТУ,
ДанныеПСС.Поступило,
ДанныеПСС.СуммаСНДС2,
ДанныеПСС.КорректировкаРегистров,
ДанныеПСС.ЗаказаноК,
ДанныеПСС.ОтгруженоК,
ДанныеПСС.ПолученоК,
ДанныеПСС.НаСумму
ИЗ ДанныеПСС  КАК ДанныеПСС
