 // Начало~,  Miracle Французова, 14/02/2025 (ВПФ Акт ввода в эксплуатацию ОС)    
 Функция СведенияОВнешнейОбработке() Экспорт
	
	ПараметрыРегистрации = Новый Структура;
	
	МассивНазначений = Новый Массив;
	МассивНазначений.Добавить("Документ.ПринятиеКУчетуОС");
	
	ПараметрыРегистрации.Вставить("Вид", "ПечатнаяФорма"); //возможны варианты - ЗаполнениеОбъекта, ДополнительныйОтчет, СозданиеСвязанныхОбъектов,
	ПараметрыРегистрации.Вставить("Назначение", МассивНазначений);
	ПараметрыРегистрации.Вставить("Наименование", "Акт  ввода в эксплуатацию основных средств (ПринятиеКУчетуОС)"); //имя под kt обработка зарегистрирована будет в справочнике внешних обработок
	ПараметрыРегистрации.Вставить("Версия", "1.1.4");
	ПараметрыРегистрации.Вставить("БезопасныйРежим", ЛОЖЬ);
	ПараметрыРегистрации.Вставить("Информация", "Акт  ввода в эксплуатацию основных средств (ПринятиеКУчетуОС)");
	
	//команды
	ТаблицаКоманд = Новый ТаблицаЗначений;
	ТаблицаКоманд.Колонки.Добавить("Представление"); //как будет выглядеть описание печ.формы для пользователя
	ТаблицаКоманд.Колонки.Добавить("Идентификатор"); //имя нашего макета
	ТаблицаКоманд.Колонки.Добавить("Использование"); //ВызовСерверногоМетода
	ТаблицаКоманд.Колонки.Добавить("ПоказыватьОповещение"); //Истина
	ТаблицаКоманд.Колонки.Добавить("Модификатор"); //ПечатьМХL
	
	НоваяКоманда = ТаблицаКоманд.Добавить();
	НоваяКоманда.Представление = "Акт  ввода в эксплуатацию основных средств";
	НоваяКоманда.Идентификатор = "СТ_АктВводаВЭксплуатациюОС"; //Внешняя печатная форма
	НоваяКоманда.Использование = "ВызовСерверногоМетода"; //здесь можно прописать использование как серверного так и клиентского, отличие в том, что серверный метод будет обращаться к экспортной процедуре из модуля объекта, клиентский - к экспортной процедуре из модуля формы объекта
	НоваяКоманда.ПоказыватьОповещение = Истина;
	НоваяКоманда.Модификатор = "ПечатьMXL";
	
	ПараметрыРегистрации.Вставить("Команды", ТаблицаКоманд);
	
	Возврат ПараметрыРегистрации;
	
КонецФункции
 // Конец~, Miracle Французова, 14/02/2025  (ВПФ Акт ввода в эксплуатацию ОС)   
 // Начало~,  Miracle Французова, 14/02/2025 (ВПФ Акт ввода в эксплуатацию ОС)   
 Процедура Печать(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт 
	
	//УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "СТ_АктВводаВЭксплуатациюОС", "СТ_АктВводаВЭксплуатациюОС", СформироватьПечатнуюФорму(МассивОбъектов[0], ОбъектыПечати));
	//ОбщегоНазначенияБП.ЗаполнитьДополнительныеПараметрыПечати(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода);	
	
	УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "СТ_АктВводаВЭксплуатациюОС", "СТ_АктВводаВЭксплуатациюОС", СформироватьПечатнуюФорму(МассивОбъектов, ОбъектыПечати));

КонецПроцедуры
 // Конец~, Miracle Французова, 14/02/2025  (ВПФ Акт ввода в эксплуатацию ОС)       
 // Начало~,  Miracle Французова, 14/02/2025 (ВПФ Акт ввода в эксплуатацию ОС)
 Функция СформироватьПечатнуюФорму(МассивОбъектов, ОбъектыПечати)
	УстановитьПривилегированныйРежим(Истина);

	Сообщение = Новый СообщениеПользователю;
	ТабличныйДокумент = Новый ТабличныйДокумент;
	ТабличныйДокумент.АвтоМасштаб			= Истина;
	ТабличныйДокумент.ОриентацияСтраницы	= ОриентацияСтраницы.Ландшафт;	
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СТ_АктВводаВЭксплуатациюОС";
	
	Макет = ПолучитьМакет("АктВводаВЭксплуатациюОС"); 
	ТекДок = МассивОбъектов;
	ПараметрыПечати = Новый Структура; 
	ПараметрыПечати.Вставить("ТекДок",ТекДок);
	
	ОбластьМакета = Макет.ПолучитьОбласть("Заголовок");
	
	ГенироватьДанныеПечати(ПараметрыПечати);
	
	ТабличныйДокумент.Вывести(ОбластьМакета);
	ТабличныйДокумент.АвтоМасштаб = Ложь;
	Возврат ТабличныйДокумент;
КонецФункции

 // Конец~, Miracle Французова, 14/02/2025  (ВПФ Акт ввода в эксплуатацию ОС) 
 // Начало~,  Miracle Французова, 14/02/2025 (ВПФ Акт ввода в эксплуатацию ОС)
 Процедура ГенироватьДанныеПечати(ПараметрыПечати)   
	 
 КонецПроцедуры

 // Конец~, Miracle Французова, 14/02/2025  (ВПФ Акт ввода в эксплуатацию ОС)












///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// + АИГ Французова 21.12.2021 (Добавление функций печати КК_УчетГСМ)

Функция ПечатьПоГСМ(МассивОбъектов, ОбъектыПечати, ПараметрыПечати)
	Запрос = Новый Запрос;
	Запрос.Текст = "
	|ВЫБРАТЬ
	|Док.Ссылка.Номер КАК НомерДок,
	|Док.Ссылка.Дата КАК ДатаДок,
	
	|NULL КАК ТекстЗаголовка,
	|NULL КАК ПредставлениеОрганизации,
	|NULL КАК ПредставлениеПодразделения,
	|NULL КАК Должность,
	|NULL КАК ФИО,
	|NULL КАК СотрудникОрганизации,
	|NULL КАК Номенклатура,
	|NULL КАК Склад,
	|NULL КАК ВидНормыРасхода,
	|NULL КАК СпидометрНаНачалоМесяца,
	|NULL КАК СпидометрНаКонецМесяца,
	|NULL КАК РасходПоНорме,
	|NULL КАК ОстатокБензинаНаНачалоМесяца,
	|NULL КАК ОстатокБензинаНаКонецМесяца,
	|NULL КАК ПолученоГСМ,
	|NULL КАК ФактическийРасход,
	|NULL КАК ПревышениеНормы
	|ИЗ Документ.КК_УчетГСМ.РасходГСМ КАК Док
	|ГДЕ Док.Ссылка = &ТекДок
	|";
	
	Запрос.УстановитьПараметр("ТекДок",МассивОбъектов[0]);
	ТабДокумент = Новый ТабличныйДокумент;

	Результат = Запрос.Выполнить().Выгрузить();
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.КК_УчетГСМ.ПечатнаяФормаПоГСМ");
	ОбластьЗаголовок            = Макет.ПолучитьОбласть("Заголовок");
	ОбластьШапка                = Макет.ПолучитьОбласть("Шапка");
	ОбластьШапкаТаблицы         = Макет.ПолучитьОбласть("ШапкаТаблицы");
	ОбластьСтрока               = Макет.ПолучитьОбласть("Строка");
	ОбластьПодписи              = Макет.ПолучитьОбласть("Подписи");  
	СтруктураШапки = ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(Результат[0]);
	СтруктураШапки.Вставить("ТекстЗаголовка",Строка(СтруктураШапки.НомерДок)+" от "+Строка(Формат(СтруктураШапки.ДатаДок,"ДФ = дд.ММ.гггг")));
	ЗаполнитьЗначенияСвойств(ОбластьШапка.Параметры,СтруктураШапки);
	ТабДокумент.Вывести(ОбластьШапка);
	ЗаполнитьЗначенияСвойств(ОбластьПодписи.Параметры,СтруктураШапки);
	ТабДокумент.Вывести(ОбластьШапкаТаблицы);

	Для каждого стр из Результат Цикл
		СК =  ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(стр);
		ЗаполнитьЗначенияСвойств(ОбластьСтрока.Параметры,СК);
		ТабДокумент.Вывести(ОбластьСтрока);
	КонецЦикла;	
	ТабДокумент.Вывести(ОбластьПодписи);
    ТабДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
	Возврат ТабДокумент;
КонецФункции
// - АИГ Французова 21.12.2021 (Добавление функций печати КК_УчетГСМ)

// + АИГ Французова 21.12.2021 (Добавление функций печати КК_УчетГСМ)

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	// ПечатнаяФормаПоГСМ
	КомандаПечати = КомандыПечати.Добавить();
	КомандаПечати.Идентификатор = "ПечатнаяФормаПоГСМ";
	КомандаПечати.Представление = НСтр("ru = 'ПечатнаяФормаПоГСМ'");
	КомандаПечати.Обработчик    = "УправлениеПечатьюБПКлиент.ВыполнитьКомандуПечати";
	КомандаПечати.ПроверкаПроведенияПередПечатью = Ложь;
	
КонецПроцедуры
// - АИГ Французова 21.12.2021 (Добавление функций печати КК_УчетГСМ)

// + АИГ Французова 21.12.2021 (Добавление функций печати КК_УчетГСМ)
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	// Проверяем, нужно ли для макета СчетЗаказа формировать табличный документ.
	Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "ПечатнаяФормаПоГСМ") Тогда
		
		// Формируем табличный документ и добавляем его в коллекцию печатных форм.
		УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "ПечатнаяФормаПоГСМ", НСтр("ru = 'ПечатнаяФормаПоГСМ'"), 
			ПечатьПоГСМ(МассивОбъектов, ОбъектыПечати, ПараметрыПечати), , "Документ.КК_УчетГСМ.ПечатнаяФормаПоГСМ");
		
	КонецЕсли;
		
	ОбщегоНазначенияБП.ЗаполнитьДополнительныеПараметрыПечати(МассивОбъектов, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода);	
	
КонецПроцедуры

// - АИГ Французова 21.12.2021 (Добавление функций печати КК_УчетГСМ)
