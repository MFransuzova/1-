//ГАС MF HD № 000090471 09.06.21 начало (печать списка сотрудников для перевода)
Функция ВернутьДанныеТЧ()
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|   ГАС_СотрудникиДляПеревода.Сотрудник КАК Сотрудник,
		|   ГАС_СотрудникиДляПеревода.ТабельныйНомер КАК ТабельныйНомер,
		|   ГАС_СотрудникиДляПеревода.Сотрудник.ДатаРождения КАК ДатаРождения,
		|   ГАС_СотрудникиДляПеревода.Должность КАК Должность,
		|   ГАС_СотрудникиДляПеревода.Подразделение КАК Подразделение,
        |   ГАС_СотрудникиДляПеревода.МестоРаботыОП КАК МестоРаботыОП,
		|   ГАС_СотрудникиДляПеревода.ДолжностьПеревод КАК ДолжностьПеревод,
		|   ГАС_СотрудникиДляПеревода.ПодразделениеПеревод КАК ПодразделениеПеревод,
		|   ГАС_СотрудникиДляПеревода.МестоРаботыОППеревод КАК МестоРаботыОППеревод,
		|   ГАС_СотрудникиДляПеревода.ПояснениеКПереводу КАК ОбоснованиеПеревода,
        |	ГАС_СотрудникиДляПеревода.Документ.Организация КАК  Организация,
        |	ГАС_СотрудникиДляПеревода.Документ.РегистрационныйНомер КАК НомерР,
		 |	ГАС_СотрудникиДляПеревода.Документ.ДатаСоздания КАК ДатаР,
		|	ГАС_СотрудникиДляПеревода.Ответственный КАК Ответственный,
		|   NULL КАК ТелефонОтветственный,
		|   &Директор КАК Директор,
		|   ГАС_СотрудникиДляПеревода.Документ.Подразделение КАК НаименованиеСтруктурногоПодразделения,
		|	АВТОНОМЕРЗАПИСИ() КАК НП,
		|	ГАС_СотрудникиДляПеревода.Документ
		|ПОМЕСТИТЬ ВТ
		|ИЗ
		|	РегистрСведений.ГАС_СотрудникиДляПеревода КАК ГАС_СотрудникиДляПеревода
		|ГДЕ
		|	ГАС_СотрудникиДляПеревода.Документ = &Документ
		|;
		|ВЫБРАТЬ
		|   ВТ.Сотрудник КАК Сотрудник,
		|   ВТ.ТабельныйНомер КАК ТабельныйНомер,
		|   ВТ.ДатаРождения КАК ДатаРождения,
		|   ВТ.Должность КАК Должность,
		|   ВТ.Подразделение КАК Подразделение,
        |   ВТ.МестоРаботыОП КАК МестоРаботыОП,
		|   ВТ.ДолжностьПеревод КАК ДолжностьПеревод,
		|   ВТ.ПодразделениеПеревод КАК ПодразделениеПеревод,
		|   ВТ.МестоРаботыОППеревод КАК МестоРаботыОППеревод,
		|   ВТ.ОбоснованиеПеревода КАК ОбоснованиеПеревода,
        |	ВЫБОР КОГДА НЕ ВТ.Организация = ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) ТОГДА ВТ.Организация ИНАЧЕ &ОрганизацияТекст КОНЕЦ КАК  Организация,
        |	ВТ.НомерР  КАК НомерДок,
		|	ВТ.ДатаР  КАК ДатаДок,

		|	ВТ.Ответственный КАК Ответственный,
		|   ВТ.ТелефонОтветственный КАК ТелефонОтветственный,
		|   ВТ.Директор КАК Директор,
		|   ВТ.НаименованиеСтруктурногоПодразделения КАК НаименованиеСтруктурногоПодразделения,
		|	ВТ.НП КАК НП,
		|	ВТ.Документ
		|ИЗ ВТ КАК ВТ
		|";
	
	Запрос.УстановитьПараметр("Документ", ДокументПеревода);
	Запрос.УстановитьПараметр("Директор","Р.Р. Габдрахманову");
	Запрос.УстановитьПараметр("ОрганизацияТекст","ООО «ГазАртСтрой»");

	Запрос.УстановитьПараметр("Пробел"," от ");
	Результат = Запрос.Выполнить().Выгрузить();

	Возврат Результат;
КонецФункции

//ГАС MF HD № 000090471 09.06.21 окончание (печать списка сотрудников для перевода)

//ГАС MF HD № 000090471 09.06.21 начало (печать списка сотрудников для перевода)
&НаСервере
Процедура НапечатьСлужебнуюЗаписку(ТД)
	Результат = ВернутьДанныеТЧ();
	Если Результат = Неопределено ИЛИ Результат.Количество()=0 Тогда
		Возврат;
	КонецЕсли;
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("РегистрСведений.ГАС_СотрудникиДляПеревода.СлужебнаяЗаписка");
	ОбластьШапка         = Макет.ПолучитьОбласть("Шапка");
	ОбластьСтроки        = Макет.ПолучитьОбласть("Строки");
	ОбластьПодвал = Макет.ПолучитьОбласть("Подвал");  
	СтруктураШапки = ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(Результат[0]);
	СтруктураШапки.Вставить("ДатаНомерДок",Строка(СтруктураШапки.НомерДок)+" от "+Строка(Формат(СтруктураШапки.ДатаДок,"ДФ = дд.ММ.гггг")));
	ЗаполнитьЗначенияСвойств(ОбластьШапка.Параметры,СтруктураШапки);
	ТД.Вывести(ОбластьШапка);
	ЗаполнитьЗначенияСвойств(ОбластьПодвал.Параметры,СтруктураШапки);
	Для каждого стр из Результат Цикл
		СК =  ОбщегоНазначения.СтрокаТаблицыЗначенийВСтруктуру(стр);
		ЗаполнитьЗначенияСвойств(ОбластьСтроки.Параметры,СК);
		ТД.Вывести(ОбластьСтроки);
	КонецЦикла;
	ТД.Вывести(ОбластьПодвал);
    ТД.ОриентацияСтраницы = ОриентацияСтраницы.Ландшафт;
КонецПроцедуры
//ГАС MF HD № 000090471 09.06.21 окончание (печать списка сотрудников для перевода)

//ГАС MF HD № 000090471 09.06.21 начало (печать списка сотрудников для перевода)
&НаКлиенте
Процедура ПечатьСлужебнуюЗаписку()

	ТД = Новый ТабличныйДокумент;
	НапечатьСлужебнуюЗаписку(ТД);
	ИдентификаторПечатнойФормы = "ПечатьСлужебнуюЗаписку";
	КоллекцияПечатныхФорм =  УправлениеПечатьюКлиент.НоваяКоллекцияПечатныхФорм(ИдентификаторПечатнойФормы);
	ОбъектыПечати = Новый Массив;
	ОбъектыПечати.Добавить(ТД);
	КоллекцияПечатныхФорм[0].ТабличныйДокумент = ОбъектыПечати[0];	
	УправлениеПечатьюКлиент.ПечатьДокументов(КоллекцияПечатныхФорм);	
КонецПроцедуры
//ГАС MF HD № 000090471 09.06.21 окончание (печать списка сотрудников для перевода)
