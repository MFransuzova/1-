Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)

 СтандартнаяОбработка = Ложь;
 Настройки = КомпоновщикНастроек.ПолучитьНастройки();
 ПараметрыДанных = Настройки.ПараметрыДанных;

 КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
 МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки, ДанныеРасшифровки, , , Ложь);
 ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;
 ПроцессорКомпоновки.Инициализировать(МакетКомпоновки,, ДанныеРасшифровки, Истина);
 ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;   
 ПроцессорВывода.УстановитьДокумент(ДокументРезультат);   
 ПроцессорВывода.НачатьВывод();   
 Пока Истина Цикл   
     ЭлементРезультата = ПроцессорКомпоновки.Следующий();
     Если ЭлементРезультата = Неопределено Тогда
    	 Прервать;
     КонецЕсли;
     ПроцессорВывода.ВывестиЭлемент(ЭлементРезультата);
 КонецЦикла;                      
 
 
 ПроцессорВывода.ЗакончитьВывод();
 ПроцессорВывода.Вывести(ПроцессорКомпоновки);
 ТабДок = ПроцессорВывода.Вывести(ПроцессорКомпоновки); 
 ПоследняяСтрока = ТабДок.ВысотаСтраницы;
 ПоследняяКолонка = ТабДок.ШиринаСтраницы;
 ОбластьЯчеек = ТабДок.Область(4,1,ПоследняяСтрока,ПоследняяКолонка);
 ИсточникДанных = Новый ОписаниеИсточникаДанных(ОбластьЯчеек);  
 ПостроительОтчета = Новый ПостроительОтчета;
 ПостроительОтчета.ИсточникДанных = ИсточникДанных;
 ПостроительОтчета.Выполнить();
 ТЗ = ПостроительОтчета.Результат.Выгрузить();
 //ПроцессорВывода.Вывести(ПроцессорКомпоновки);
КонецПроцедуры 
