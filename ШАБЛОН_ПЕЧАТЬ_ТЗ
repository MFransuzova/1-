Процедура ПечатьТЗ1(ТЗ,Шапка,Подвал)
	ТабДок = Новый ТабличныйДокумент;
	РазмерШ = 12;
	Жирный = Истина; 
	
	Рамка = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
	К = 1;    
	Если Шапка<>"" Тогда
		ТабДок.Область("R"+Строка(К)+"C"+Строка(К)).Текст = Шапка;
		ТабДок.Область("R"+Строка(К)+"C"+Строка(К)).Шрифт = Новый Шрифт(,РазмерШ,Жирный,,);
		К=К+4;
	КонецЕсли;	
	ВсегоКолонок = 0;
	
	Для Каждого Колонка Из ТЗ.Колонки Цикл
		ВсегоКолонок = ВсегоКолонок+1;
		ТабДок.Область("R"+Строка(К)+"C"+Строка(ВсегоКолонок)).Текст = Строка(Колонка.Имя);
		ТабДок.Область("R"+Строка(К)+"C"+Строка(ВсегоКолонок)).Обвести(Рамка,Рамка,Рамка,Рамка);
	КонецЦикла;
	К = К+1;
	
	КолКолонок = 1;	
	Для каждого стр ИЗ ТЗ Цикл
		КолКолонок = 1;	
		Для Каждого Колонка Из ТЗ.Колонки Цикл
			значениеСтроки = стр[Колонка.Имя];
			Если  Строка(значениеСтроки)="" Тогда
				значениеСтроки = "            ";
			КонецЕсли;	
			Если СтрДлина(Колонка.Имя)> СтрДлина(значениеСтроки) Тогда
				ШиринаКолонки = СтрДлина(Колонка.Имя);
			Иначе
				ШиринаКолонки = СтрДлина(значениеСтроки);
			КонецЕсли;		 
			Попытка
				ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Текст = значениеСтроки;
				ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Обвести(Рамка,Рамка,Рамка,Рамка);
				ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Расшифровка = значениеСтроки;
				ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).ШиринаКолонки = ШиринаКолонки;
			Исключение
			КонецПопытки;
			КолКолонок=КолКолонок+1;
		КонецЦикла;
		К=К+1;
	КонецЦикла;
	
	Попытка
		ТабДок.Область("R1"+"C"+КолКолонок+":"+"R"+Строка(К)+"C"+КолКолонок).Обвести(Рамка,Рамка,,);
	Исключение
	КонецПопытки;
	Попытка
		Если Подвал<>"" Тогда
			КолКолонок = КолКолонок-1;
			ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Текст = Подвал;
			ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Шрифт = Новый Шрифт(,РазмерШ,Жирный,,);
		КонецЕсли;
	Исключение
	КонецПопытки;
	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.ТолькоПросмотр = Истина;
	ТабДок.Показать();	
КонецПроцедуры
