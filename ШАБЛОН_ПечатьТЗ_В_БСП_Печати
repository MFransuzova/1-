// + ДБ Французова 10.10.2022  1532
&НаСервере
Функция ДБ_ВывестиСсылкиНаОбъектСервер(СтруктураВывода)
	МассивПоиска = Новый Массив;
	Для каждого эл из СтруктураВывода.МассивОбъектов Цикл
		МассивПоиска.Добавить(эл.Ссылка);
	КонецЦикла;
	НайденныеДанные = НайтиПоСсылкам(МассивПоиска);  
	НайденныеДанные.Колонки.Удалить("Метаданные");
	НайденныеДанные.Колонки.Удалить("РазделениеДанных");
	Возврат НайденныеДанные;//ОбщегоНазначенияУТ.ТабличныйДокументИзТаблицыЗначений(НайденныеДанные);
КонецФункции

// - ДБ Французова 10.10.2022  1532

// + ДБ Французова 10.10.2022  1532
&НаСервере
Процедура ПечатьТЗ1(Шапка,Подвал,СтруктураВывода)
	ТЗ = ДБ_ВывестиСсылкиНаОбъектСервер(СтруктураВывода);
	ТабДок = СтруктураВывода.ТД;
	РазмерШ = 12;
	Жирный = Истина; 
	
	Рамка = Новый Линия(ТипЛинииЯчейкиТабличногоДокумента.Сплошная, 1);
	К = 1;    
	Если Шапка<>"" Тогда
		ТабДок.Область("R"+Строка(К)+"C"+Строка(К)).Текст = Шапка;
		ТабДок.Область("R"+Строка(К)+"C"+Строка(К)).Шрифт = Новый Шрифт(,РазмерШ,Жирный,,);
		К=К+4;
	КонецЕсли;	
	ВсегоКолонок = 0;
	
	Для Каждого Колонка Из ТЗ.Колонки Цикл
		ВсегоКолонок = ВсегоКолонок+1;
		ТабДок.Область("R"+Строка(К)+"C"+Строка(ВсегоКолонок)).Текст = Строка(Колонка.Имя);
		ТабДок.Область("R"+Строка(К)+"C"+Строка(ВсегоКолонок)).Обвести(Рамка,Рамка,Рамка,Рамка);
	КонецЦикла;
	К = К+1;
	
	КолКолонок = 1;	
	Для каждого стр ИЗ ТЗ Цикл
		КолКолонок = 1;	
		Для Каждого Колонка Из ТЗ.Колонки Цикл
			значениеСтроки = стр[Колонка.Имя];
			Если  Строка(значениеСтроки)="" Тогда
				значениеСтроки = "            ";
			КонецЕсли;	
			Если СтрДлина(Колонка.Имя)> СтрДлина(значениеСтроки) Тогда
				ШиринаКолонки = СтрДлина(Колонка.Имя);
			Иначе
				ШиринаКолонки = СтрДлина(значениеСтроки);
			КонецЕсли;		 
			Попытка
				ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Текст = значениеСтроки;
				ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Обвести(Рамка,Рамка,Рамка,Рамка);
				ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Расшифровка = значениеСтроки;
				ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).ШиринаКолонки = ШиринаКолонки;
			Исключение
			КонецПопытки;
			КолКолонок=КолКолонок+1;
		КонецЦикла;
		К=К+1;
	КонецЦикла;
	
	Попытка
		ТабДок.Область("R1"+"C"+КолКолонок+":"+"R"+Строка(К)+"C"+КолКолонок).Обвести(Рамка,Рамка,,);
	Исключение
	КонецПопытки;
	Попытка
		Если Подвал<>"" Тогда
			КолКолонок = КолКолонок-1;
			ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Текст = Подвал;
			ТабДок.Область("R"+Строка(К)+"C"+КолКолонок).Шрифт = Новый Шрифт(,РазмерШ,Жирный,,);
		КонецЕсли;
	Исключение
	КонецПопытки;
	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.ТолькоПросмотр = Истина;
	ТабДок.ОтображатьЗаголовки = Ложь;
	
	
КонецПроцедуры
// - ДБ Французова 10.10.2022  1532

// + ДБ Французова 10.10.2022  1532
&НаКлиенте
Процедура ДБ_ВывестиСсылкиНаОбъект(Команда)
	текОбъект = ЭтаФорма.Элементы.СписокРасширенныйПоискНоменклатура.ТекущиеДанные;  
	СтруктураВывода = Новый Структура;
	МассивОбъектов = Новый Массив;
	МассивОбъектов.Добавить(текОбъект);
	СтруктураВывода.Вставить("МассивОбъектов",МассивОбъектов);
	СтруктураВывода.Вставить("ТД",Новый ТабличныйДокумент);
	//ТабДок = ДБ_ВывестиСсылкиНаОбъектСервер(СтруктураВывода) ;
	ПечатьТЗ1("","",СтруктураВывода);
	//СтруктураВывода.ТД.Показать();
	КоллекцияПечатныхФорм = УправлениеПечатьюКлиент.НоваяКоллекцияПечатныхФорм("МакетТест");    
	КоллекцияПечатныхФорм[0].ТабличныйДокумент = СтруктураВывода.ТД; 
	КоллекцияПечатныхФорм[0].Экземпляров=1;
	КоллекцияПечатныхФорм[0].СинонимМакета = "Макет тест";  // используется для формирования имени файла при сохранении из общей формы печати документов
	УправлениеПечатьюКлиент.ПечатьДокументов(КоллекцияПечатныхФорм,Неопределено,ЭтаФорма);
	//

		//УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "СсылкиОбъектов", НСтр("ru = 'СсылкиОбъектов'"), 
	//ДБ_ВывестиСсылкиНаОбъектСервер(СтруктураВывода), , );
КонецПроцедуры

// - ДБ Французова 10.10.2022  1532
// + ДБ Французова 10.10.2022  1532
&НаСервере
Процедура ДБ_КомандыФормы()
	Команда_СсылкиНаОбъект                       = ЭтаФорма.Команды.Добавить("ДБ_СсылкиНаОбъект");
	Команда_СсылкиНаОбъект.Действие              = "ДБ_ВывестиСсылкиНаОбъект";
	
	Кнопка_СсылкиНаОбъект                        = Элементы.Добавить("Кнопка_ДБ_СсылкиНаОбъект", Тип("КнопкаФормы"), Элементы.ГруппаСписокНоменклатуры);
	Кнопка_СсылкиНаОбъект.Вид                    = ВидКнопкиФормы.ОбычнаяКнопка;
	Кнопка_СсылкиНаОбъект.ИмяКоманды             = "ДБ_СсылкиНаОбъект";
	Кнопка_СсылкиНаОбъект.Заголовок              = "Вывести ссылки";
	
КонецПроцедуры

// - ДБ Французова 10.10.2022  1532
